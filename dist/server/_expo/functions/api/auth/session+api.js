var __BUNDLE_START_TIME__=globalThis.nativePerformanceNow?nativePerformanceNow():Date.now(),__DEV__=false,process=globalThis.process||{},__METRO_GLOBAL_PREFIX__='';
!(function(e){"use strict";e.__r=i,e[`${__METRO_GLOBAL_PREFIX__}__d`]=function(e,n,o){if(t.has(n))return;const i={dependencyMap:o,factory:e,hasError:!1,importedAll:r,importedDefault:r,isInitialized:!1,publicModule:{exports:{}}};t.set(n,i)},e.__c=o,e.__registerSegment=function(e,r,n){p[e]=r,n&&n.forEach(r=>{t.has(r)||h.has(r)||h.set(r,e)})};var t=o();const r={},{hasOwnProperty:n}={};function o(){return t=new Map}function i(e){const r=e,n=t.get(r);return n&&n.isInitialized?n.publicModule.exports:d(r,n)}function l(e){const n=e,o=t.get(n);if(o&&o.importedDefault!==r)return o.importedDefault;const l=i(n),u=l&&l.__esModule?l.default:l;return t.get(n).importedDefault=u}function u(e){const o=e,l=t.get(o);if(l&&l.importedAll!==r)return l.importedAll;const u=i(o);let c;if(u&&u.__esModule)c=u;else{if(c={},u)for(const e in u)n.call(u,e)&&(c[e]=u[e]);c.default=u}return t.get(o).importedAll=c}i.importDefault=l,i.importAll=u,i.context=function(){throw new Error("The experimental Metro feature `require.context` is not enabled in your project.")},i.resolveWeak=function(){throw new Error("require.resolveWeak cannot be called dynamically.")};let c=!1;function d(t,r){if(!c&&e.ErrorUtils){let n;c=!0;try{n=g(t,r)}catch(t){e.ErrorUtils.reportFatalError(t)}return c=!1,n}return g(t,r)}const a=16,s=65535;function f(e){return{segmentId:e>>>a,localId:e&s}}i.unpackModuleId=f,i.packModuleId=function(e){return(e.segmentId<<a)+e.localId};const p=[],h=new Map;function g(r,n){if(!n&&p.length>0){const e=h.get(r)??0,o=p[e];null!=o&&(o(r),n=t.get(r),h.delete(r))}const o=e.nativeRequire;if(!n&&o){const{segmentId:e,localId:i}=f(r);o(i,e),n=t.get(r)}if(!n)throw _(r);if(n.hasError)throw n.error;n.isInitialized=!0;const{factory:c,dependencyMap:d}=n;try{const t=n.publicModule;return t.id=r,c(e,i,l,u,t,t.exports,d),n.factory=void 0,n.dependencyMap=void 0,t.exports}catch(e){throw n.hasError=!0,n.error=e,n.isInitialized=!1,n.publicModule.exports=void 0,e}}function _(e){return Error('Requiring unknown module "'+e+'".')}})('undefined'!=typeof globalThis?globalThis:'undefined'!=typeof global?global:'undefined'!=typeof window?window:this);
!(function(e){e.$$require_external=require})('undefined'!=typeof globalThis?globalThis:'undefined'!=typeof global?global:'undefined'!=typeof window?window:this);
'undefined'!=typeof globalThis?globalThis:'undefined'!=typeof global?global:'undefined'!=typeof window&&window;
!(function(r){let n=0,t=function(r,n){throw r};const l={setGlobalHandler(r){t=r},getGlobalHandler:()=>t,reportError(r){t&&t(r,!1)},reportFatalError(r){t&&t(r,!0)},applyWithGuard(r,t,e,o,a){try{return n++,r.apply(t,e)}catch(r){l.reportError(r)}finally{n--}return null},applyWithGuardIfNeeded:(r,n,t)=>l.inGuard()?r.apply(n,t):(l.applyWithGuard(r,n,t),null),inGuard:()=>!!n,guard(r,n,t){if('function'!=typeof r)return console.warn('A function must be passed to ErrorUtils.guard, got ',r),null;const e=n??r.name??'<generated guard>';return function(...n){return l.applyWithGuard(r,t??this,n,null,e)}}};r.ErrorUtils=l})('undefined'!=typeof globalThis?globalThis:'undefined'!=typeof global?global:'undefined'!=typeof window?window:this);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.REFRESH_TOKEN_MAX_AGE=e.REFRESH_TOKEN_EXPIRY=e.REFRESH_COOKIE_OPTIONS=e.REFRESH_COOKIE_NAME=e.REFRESH_BEFORE_EXPIRY_SEC=e.JWT_SECRET=e.JWT_EXPIRATION_TIME=e.GOOGLE_REDIRECT_URI=e.GOOGLE_CLIENT_SECRET=e.GOOGLE_CLIENT_ID=e.GOOGLE_AUTH_URL=e.COOKIE_OPTIONS=e.COOKIE_NAME=e.COOKIE_MAX_AGE=e.BASE_URL=e.APP_SCHEME=e.APPLE_REDIRECT_URI=e.APPLE_CLIENT_SECRET=e.APPLE_CLIENT_ID=e.APPLE_AUTH_URL=void 0;e.COOKIE_NAME="auth_token",e.REFRESH_COOKIE_NAME="refresh_token";const E=e.COOKIE_MAX_AGE=20,_=(e.JWT_EXPIRATION_TIME="30d",e.REFRESH_TOKEN_EXPIRY="30d",e.REFRESH_TOKEN_MAX_AGE=2592e3);e.REFRESH_BEFORE_EXPIRY_SEC=60,e.GOOGLE_CLIENT_ID=process.env.GOOGLE_CLIENT_ID,e.GOOGLE_CLIENT_SECRET=process.env.GOOGLE_CLIENT_SECRET,e.GOOGLE_REDIRECT_URI=`${process.env.EXPO_PUBLIC_BASE_URL}/api/auth/callback`,e.GOOGLE_AUTH_URL="https://accounts.google.com/o/oauth2/v2/auth",e.APPLE_CLIENT_ID="com.beto.expoauthexample.web",e.APPLE_CLIENT_SECRET=process.env.APPLE_CLIENT_SECRET,e.APPLE_REDIRECT_URI=`${process.env.EXPO_PUBLIC_BASE_URL}/api/auth/apple/callback`,e.APPLE_AUTH_URL="https://appleid.apple.com/auth/authorize",e.BASE_URL=process.env.EXPO_PUBLIC_BASE_URL,e.APP_SCHEME=process.env.EXPO_PUBLIC_SCHEME,e.JWT_SECRET=process.env.JWT_SECRET,e.COOKIE_OPTIONS={httpOnly:!0,secure:!0,sameSite:"Lax",path:"/",maxAge:E},e.REFRESH_COOKIE_OPTIONS={httpOnly:!0,secure:!0,sameSite:"Lax",path:"/api/auth/refresh",maxAge:_}},754,[]);
__d(function(g,_r,_i,a,m,_e,d){Object.defineProperty(_e,"__esModule",{value:!0}),Object.defineProperty(_e,"CompactEncrypt",{enumerable:!0,get:function(){return p.CompactEncrypt}}),Object.defineProperty(_e,"CompactSign",{enumerable:!0,get:function(){return l.CompactSign}}),Object.defineProperty(_e,"EmbeddedJWK",{enumerable:!0,get:function(){return S.EmbeddedJWK}}),Object.defineProperty(_e,"EncryptJWT",{enumerable:!0,get:function(){return O.EncryptJWT}}),Object.defineProperty(_e,"FlattenedEncrypt",{enumerable:!0,get:function(){return b.FlattenedEncrypt}}),Object.defineProperty(_e,"FlattenedSign",{enumerable:!0,get:function(){return y.FlattenedSign}}),Object.defineProperty(_e,"GeneralEncrypt",{enumerable:!0,get:function(){return n.GeneralEncrypt}}),Object.defineProperty(_e,"GeneralSign",{enumerable:!0,get:function(){return P.GeneralSign}}),Object.defineProperty(_e,"SignJWT",{enumerable:!0,get:function(){return j.SignJWT}}),Object.defineProperty(_e,"UnsecuredJWT",{enumerable:!0,get:function(){return s.UnsecuredJWT}}),_e.base64url=void 0,Object.defineProperty(_e,"calculateJwkThumbprint",{enumerable:!0,get:function(){return J.calculateJwkThumbprint}}),Object.defineProperty(_e,"calculateJwkThumbprintUri",{enumerable:!0,get:function(){return J.calculateJwkThumbprintUri}}),Object.defineProperty(_e,"compactDecrypt",{enumerable:!0,get:function(){return e.compactDecrypt}}),Object.defineProperty(_e,"compactVerify",{enumerable:!0,get:function(){return c.compactVerify}}),Object.defineProperty(_e,"createLocalJWKSet",{enumerable:!0,get:function(){return K.createLocalJWKSet}}),Object.defineProperty(_e,"createRemoteJWKSet",{enumerable:!0,get:function(){return W.createRemoteJWKSet}}),_e.cryptoRuntime=void 0,Object.defineProperty(_e,"customFetch",{enumerable:!0,get:function(){return W.customFetch}}),Object.defineProperty(_e,"decodeJwt",{enumerable:!0,get:function(){return E.decodeJwt}}),Object.defineProperty(_e,"decodeProtectedHeader",{enumerable:!0,get:function(){return h.decodeProtectedHeader}}),_e.errors=void 0,Object.defineProperty(_e,"exportJWK",{enumerable:!0,get:function(){return w.exportJWK}}),Object.defineProperty(_e,"exportPKCS8",{enumerable:!0,get:function(){return w.exportPKCS8}}),Object.defineProperty(_e,"exportSPKI",{enumerable:!0,get:function(){return w.exportSPKI}}),Object.defineProperty(_e,"flattenedDecrypt",{enumerable:!0,get:function(){return t.flattenedDecrypt}}),Object.defineProperty(_e,"flattenedVerify",{enumerable:!0,get:function(){return u.flattenedVerify}}),Object.defineProperty(_e,"generalDecrypt",{enumerable:!0,get:function(){return r.generalDecrypt}}),Object.defineProperty(_e,"generalVerify",{enumerable:!0,get:function(){return o.generalVerify}}),Object.defineProperty(_e,"generateKeyPair",{enumerable:!0,get:function(){return _.generateKeyPair}}),Object.defineProperty(_e,"generateSecret",{enumerable:!0,get:function(){return k.generateSecret}}),Object.defineProperty(_e,"importJWK",{enumerable:!0,get:function(){return C.importJWK}}),Object.defineProperty(_e,"importPKCS8",{enumerable:!0,get:function(){return C.importPKCS8}}),Object.defineProperty(_e,"importSPKI",{enumerable:!0,get:function(){return C.importSPKI}}),Object.defineProperty(_e,"importX509",{enumerable:!0,get:function(){return C.importX509}}),Object.defineProperty(_e,"jwksCache",{enumerable:!0,get:function(){return W.jwksCache}}),Object.defineProperty(_e,"jwtDecrypt",{enumerable:!0,get:function(){return f.jwtDecrypt}}),Object.defineProperty(_e,"jwtVerify",{enumerable:!0,get:function(){return i.jwtVerify}});var e=_r(d[0]),t=_r(d[1]),r=_r(d[2]),n=_r(d[3]),c=_r(d[4]),u=_r(d[5]),o=_r(d[6]),i=_r(d[7]),f=_r(d[8]),p=_r(d[9]),b=_r(d[10]),l=_r(d[11]),y=_r(d[12]),P=_r(d[13]),j=_r(d[14]),O=_r(d[15]),J=_r(d[16]),S=_r(d[17]),K=_r(d[18]),W=_r(d[19]),s=_r(d[20]),w=_r(d[21]),C=_r(d[22]),h=_r(d[23]),E=_r(d[24]),T=v(_r(d[25]));_e.errors=T;var _=_r(d[26]),k=_r(d[27]),D=v(_r(d[28]));function v(e,t){if("function"==typeof WeakMap)var r=new WeakMap,n=new WeakMap;return(v=function(e,t){if(!t&&e&&e.__esModule)return e;var c,u,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(c=t?n:r){if(c.has(e))return c.get(e);c.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((u=(c=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(u.get||u.set)?c(o,t,u):o[t]=e[t]);return o})(e,t)}_e.base64url=D;_e.cryptoRuntime='WebCryptoAPI'},755,[756,757,789,790,796,797,801,802,804,805,791,806,807,809,810,811,812,813,814,815,816,794,779,817,818,763,819,820,758]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.compactDecrypt=async function(c,p,y){c instanceof Uint8Array&&(c=o.decoder.decode(c));if('string'!=typeof c)throw new n.JWEInvalid('Compact JWE must be a string or Uint8Array');const{0:f,1:l,2:s,3:v,4:u,length:w}=c.split('.');if(5!==w)throw new n.JWEInvalid('Invalid Compact JWE');const _=await(0,t.flattenedDecrypt)({ciphertext:v,iv:s||void 0,protected:f,tag:u||void 0,encrypted_key:l||void 0},p,y),h={plaintext:_.plaintext,protectedHeader:_.protectedHeader};if('function'==typeof p)return{...h,key:_.key};return h};var t=r(d[0]),n=r(d[1]),o=r(d[2])},756,[757,763,759]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.flattenedDecrypt=async function(J,f,W){if(!(0,l.isObject)(J))throw new n.JWEInvalid('Flattened JWE must be an object');if(void 0===J.protected&&void 0===J.header&&void 0===J.unprotected)throw new n.JWEInvalid('JOSE Header missing');if(void 0!==J.iv&&'string'!=typeof J.iv)throw new n.JWEInvalid('JWE Initialization Vector incorrect type');if('string'!=typeof J.ciphertext)throw new n.JWEInvalid('JWE Ciphertext missing or incorrect type');if(void 0!==J.tag&&'string'!=typeof J.tag)throw new n.JWEInvalid('JWE Authentication Tag incorrect type');if(void 0!==J.protected&&'string'!=typeof J.protected)throw new n.JWEInvalid('JWE Protected Header incorrect type');if(void 0!==J.encrypted_key&&'string'!=typeof J.encrypted_key)throw new n.JWEInvalid('JWE Encrypted Key incorrect type');if(void 0!==J.aad&&'string'!=typeof J.aad)throw new n.JWEInvalid('JWE AAD incorrect type');if(void 0!==J.header&&!(0,l.isObject)(J.header))throw new n.JWEInvalid('JWE Shared Unprotected Header incorrect type');if(void 0!==J.unprotected&&!(0,l.isObject)(J.unprotected))throw new n.JWEInvalid('JWE Per-Recipient Unprotected Header incorrect type');let u;if(J.protected)try{const o=(0,t.decode)(J.protected);u=JSON.parse(h.decoder.decode(o))}catch{throw new n.JWEInvalid('JWE Protected Header is invalid')}if(!(0,c.isDisjoint)(u,J.header,J.unprotected))throw new n.JWEInvalid('JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint');const I={...u,...J.header,...J.unprotected};if((0,w.validateCrit)(n.JWEInvalid,new Map,W?.crit,u,I),void 0!==I.zip)throw new n.JOSENotSupported('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');const{alg:A,enc:H}=I;if('string'!=typeof A||!A)throw new n.JWEInvalid('missing JWE Algorithm (alg) in JWE Header');if('string'!=typeof H||!H)throw new n.JWEInvalid('missing JWE Encryption Algorithm (enc) in JWE Header');const b=W&&(0,y.validateAlgorithms)('keyManagementAlgorithms',W.keyManagementAlgorithms),P=W&&(0,y.validateAlgorithms)('contentEncryptionAlgorithms',W.contentEncryptionAlgorithms);if(b&&!b.has(A)||!b&&A.startsWith('PBES2'))throw new n.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter value not allowed');if(P&&!P.has(H))throw new n.JOSEAlgNotAllowed('"enc" (Encryption Algorithm) Header Parameter value not allowed');let k;if(void 0!==J.encrypted_key)try{k=(0,t.decode)(J.encrypted_key)}catch{throw new n.JWEInvalid('Failed to base64url decode the encrypted_key')}let O=!1;'function'==typeof f&&(f=await f(u,J),O=!0);(0,E.checkKeyType)('dir'===A?H:A,f,'decrypt');const S=await(0,v.normalizeKey)(f,A);let _,j,F;try{_=await(0,p.decryptKeyManagement)(A,S,k,I,W)}catch(t){if(t instanceof TypeError||t instanceof n.JWEInvalid||t instanceof n.JOSENotSupported)throw t;_=(0,s.generateCek)(H)}if(void 0!==J.iv)try{j=(0,t.decode)(J.iv)}catch{throw new n.JWEInvalid('Failed to base64url decode the iv')}if(void 0!==J.tag)try{F=(0,t.decode)(J.tag)}catch{throw new n.JWEInvalid('Failed to base64url decode the tag')}const U=void 0!==J.protected?(0,h.encode)(J.protected):new Uint8Array;let x,M;x=void 0!==J.aad?(0,h.concat)(U,(0,h.encode)('.'),(0,h.encode)(J.aad)):U;try{M=(0,t.decode)(J.ciphertext)}catch{throw new n.JWEInvalid('Failed to base64url decode the ciphertext')}const N={plaintext:await(0,o.decrypt)(H,_,M,j,F,x)};void 0!==J.protected&&(N.protectedHeader=u);if(void 0!==J.aad)try{N.additionalAuthenticatedData=(0,t.decode)(J.aad)}catch{throw new n.JWEInvalid('Failed to base64url decode the aad')}void 0!==J.unprotected&&(N.sharedUnprotectedHeader=J.unprotected);void 0!==J.header&&(N.unprotectedHeader=J.header);if(O)return{...N,key:S};return N};var t=r(d[0]),o=r(d[1]),n=r(d[2]),c=r(d[3]),l=r(d[4]),p=r(d[5]),h=r(d[6]),s=r(d[7]),w=r(d[8]),y=r(d[9]),v=r(d[10]),E=r(d[11])},757,[758,761,763,769,770,771,759,778,784,785,786,788]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.decode=function(n){if(Uint8Array.fromBase64)return Uint8Array.fromBase64('string'==typeof n?n:t.decoder.decode(n),{alphabet:'base64url'});let c=n;c instanceof Uint8Array&&(c=t.decoder.decode(c));c=c.replace(/-/g,'+').replace(/_/g,'/');try{return(0,o.decodeBase64)(c)}catch{throw new TypeError('The input to be decoded is not correctly encoded.')}},e.encode=function(n){let c=n;'string'==typeof c&&(c=t.encoder.encode(c));if(Uint8Array.prototype.toBase64)return c.toBase64({alphabet:'base64url',omitPadding:!0});return(0,o.encodeBase64)(c).replace(/=/g,'').replace(/\+/g,'-').replace(/\//g,'_')};var t=r(d[0]),o=r(d[1])},758,[759,760]);
__d(function(g,r,_i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.concat=function(...n){const t=n.reduce((n,{length:t})=>n+t,0),o=new Uint8Array(t);let c=0;for(const t of n)o.set(t,c),c+=t.length;return o},e.decoder=void 0,e.encode=function(n){const t=new Uint8Array(n.length);for(let o=0;o<n.length;o++){const c=n.charCodeAt(o);if(c>127)throw new TypeError('non-ASCII string encountered in encode()');t[o]=c}return t},e.encoder=void 0,e.uint32be=function(n){const o=new Uint8Array(4);return t(o,n),o},e.uint64be=function(o){const c=Math.floor(o/n),i=o%n,u=new Uint8Array(8);return t(u,c,0),t(u,i,4),u};e.encoder=new TextEncoder,e.decoder=new TextDecoder;const n=4294967296;function t(t,o,c){if(o<0||o>=n)throw new RangeError(`value must be >= 0 and <= 4294967295. Received ${o}`);t.set([o>>>24,o>>>16,o>>>8,255&o],c)}},759,[]);
__d(function(g,r,_i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.decodeBase64=function(t){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(t);const n=atob(t),o=new Uint8Array(n.length);for(let t=0;t<n.length;t++)o[t]=n.charCodeAt(t);return o},e.encodeBase64=function(t){if(Uint8Array.prototype.toBase64)return t.toBase64();const n=[];for(let o=0;o<t.length;o+=32768)n.push(String.fromCharCode.apply(null,t.subarray(o,o+32768)));return btoa(n.join(''))}},760,[]);
__d(function(g,r,_i,_a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.decrypt=async function(t,c,s,u,A,l){if(!((0,y.isCryptoKey)(c)||c instanceof Uint8Array))throw new TypeError((0,o.invalidKeyInput)(c,'CryptoKey','KeyObject','Uint8Array','JSON Web Key'));if(!u)throw new i.JWEInvalid('JWE Initialization Vector missing');if(!A)throw new i.JWEInvalid('JWE Authentication Tag missing');switch((0,n.checkIvLength)(t,u),t){case'A128CBC-HS256':case'A192CBC-HS384':case'A256CBC-HS512':return c instanceof Uint8Array&&(0,a.checkCekLength)(c,parseInt(t.slice(-3),10)),p(t,c,s,u,A,l);case'A128GCM':case'A192GCM':case'A256GCM':return c instanceof Uint8Array&&(0,a.checkCekLength)(c,parseInt(t.slice(1,4),10)),w(t,c,s,u,A,l);default:throw new i.JOSENotSupported('Unsupported JWE Content Encryption Algorithm')}};var t=r(d[0]),n=r(d[1]),a=r(d[2]),i=r(d[3]),c=r(d[4]),o=r(d[5]),y=r(d[6]);async function s(t,n){if(!(t instanceof Uint8Array))throw new TypeError('First argument must be a buffer');if(!(n instanceof Uint8Array))throw new TypeError('Second argument must be a buffer');const a={name:'HMAC',hash:'SHA-256'},i=await crypto.subtle.generateKey(a,!1,['sign']),c=new Uint8Array(await crypto.subtle.sign(a,i,t)),o=new Uint8Array(await crypto.subtle.sign(a,i,n));let y=0,s=-1;for(;++s<32;)y|=c[s]^o[s];return 0===y}async function p(n,a,c,y,p,w){if(!(a instanceof Uint8Array))throw new TypeError((0,o.invalidKeyInput)(a,'Uint8Array'));const u=parseInt(n.slice(1,4),10),A=await crypto.subtle.importKey('raw',a.subarray(u>>3),'AES-CBC',!1,['decrypt']),l=await crypto.subtle.importKey('raw',a.subarray(0,u>>3),{hash:"SHA-"+(u<<1),name:'HMAC'},!1,['sign']),h=(0,t.concat)(w,y,c,(0,t.uint64be)(w.length<<3)),f=new Uint8Array((await crypto.subtle.sign('HMAC',l,h)).slice(0,u>>3));let C,b;try{C=await s(p,f)}catch{}if(!C)throw new i.JWEDecryptionFailed;try{b=new Uint8Array(await crypto.subtle.decrypt({iv:y,name:'AES-CBC'},A,c))}catch{}if(!b)throw new i.JWEDecryptionFailed;return b}async function w(n,a,o,y,s,p){let w;a instanceof Uint8Array?w=await crypto.subtle.importKey('raw',a,'AES-GCM',!1,['decrypt']):((0,c.checkEncCryptoKey)(a,n,'decrypt'),w=a);try{return new Uint8Array(await crypto.subtle.decrypt({additionalData:p,iv:y,name:'AES-GCM',tagLength:128},w,(0,t.concat)(o,s)))}catch{throw new i.JWEDecryptionFailed}}},761,[759,762,765,763,766,767,768]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.checkIvLength=function(l,o){if(o.length<<3!==(0,t.bitLength)(l))throw new n.JWEInvalid('Invalid Initialization Vector length')};var n=r(d[0]),t=r(d[1])},762,[763,764]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.JWTInvalid=e.JWTExpired=e.JWTClaimValidationFailed=e.JWSSignatureVerificationFailed=e.JWSInvalid=e.JWKSTimeout=e.JWKSNoMatchingKey=e.JWKSMultipleMatchingKeys=e.JWKSInvalid=e.JWKInvalid=e.JWEInvalid=e.JWEDecryptionFailed=e.JOSENotSupported=e.JOSEError=e.JOSEAlgNotAllowed=void 0;class t extends Error{static code='ERR_JOSE_GENERIC';code='ERR_JOSE_GENERIC';constructor(t,c){super(t,c),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}e.JOSEError=t;e.JWTClaimValidationFailed=class extends t{static code='ERR_JWT_CLAIM_VALIDATION_FAILED';code='ERR_JWT_CLAIM_VALIDATION_FAILED';constructor(t,c,s="unspecified",o="unspecified"){super(t,{cause:{claim:s,reason:o,payload:c}}),this.claim=s,this.reason=o,this.payload=c}};e.JWTExpired=class extends t{static code='ERR_JWT_EXPIRED';code='ERR_JWT_EXPIRED';constructor(t,c,s="unspecified",o="unspecified"){super(t,{cause:{claim:s,reason:o,payload:c}}),this.claim=s,this.reason=o,this.payload=c}};e.JOSEAlgNotAllowed=class extends t{static code='ERR_JOSE_ALG_NOT_ALLOWED';code='ERR_JOSE_ALG_NOT_ALLOWED'};e.JOSENotSupported=class extends t{static code='ERR_JOSE_NOT_SUPPORTED';code='ERR_JOSE_NOT_SUPPORTED'};e.JWEDecryptionFailed=class extends t{static code='ERR_JWE_DECRYPTION_FAILED';code='ERR_JWE_DECRYPTION_FAILED';constructor(t="decryption operation failed",c){super(t,c)}};e.JWEInvalid=class extends t{static code='ERR_JWE_INVALID';code='ERR_JWE_INVALID'};e.JWSInvalid=class extends t{static code='ERR_JWS_INVALID';code='ERR_JWS_INVALID'};e.JWTInvalid=class extends t{static code='ERR_JWT_INVALID';code='ERR_JWT_INVALID'};e.JWKInvalid=class extends t{static code='ERR_JWK_INVALID';code='ERR_JWK_INVALID'};e.JWKSInvalid=class extends t{static code='ERR_JWKS_INVALID';code='ERR_JWKS_INVALID'};e.JWKSNoMatchingKey=class extends t{static code='ERR_JWKS_NO_MATCHING_KEY';code='ERR_JWKS_NO_MATCHING_KEY';constructor(t="no applicable key found in the JSON Web Key Set",c){super(t,c)}};e.JWKSMultipleMatchingKeys=class extends t{static code='ERR_JWKS_MULTIPLE_MATCHING_KEYS';code='ERR_JWKS_MULTIPLE_MATCHING_KEYS';constructor(t="multiple matching keys found in the JSON Web Key Set",c){super(t,c)}};e.JWKSTimeout=class extends t{static code='ERR_JWKS_TIMEOUT';code='ERR_JWKS_TIMEOUT';constructor(t="request timed out",c){super(t,c)}};e.JWSSignatureVerificationFailed=class extends t{static code='ERR_JWS_SIGNATURE_VERIFICATION_FAILED';code='ERR_JWS_SIGNATURE_VERIFICATION_FAILED';constructor(t="signature verification failed",c){super(t,c)}}},763,[]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.bitLength=n,e.generateIv=void 0;var t=r(d[0]);function n(n){switch(n){case'A128GCM':case'A128GCMKW':case'A192GCM':case'A192GCMKW':case'A256GCM':case'A256GCMKW':return 96;case'A128CBC-HS256':case'A192CBC-HS384':case'A256CBC-HS512':return 128;default:throw new t.JOSENotSupported(`Unsupported JWE Algorithm: ${n}`)}}e.generateIv=t=>crypto.getRandomValues(new Uint8Array(n(t)>>3))},764,[763]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.checkCekLength=function(n,o){const c=n.byteLength<<3;if(c!==o)throw new t.JWEInvalid(`Invalid Content Encryption Key length. Expected ${o} bits, got ${c} bits`)};var t=r(d[0])},765,[763]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.checkEncCryptoKey=function(h,n,S){switch(n){case'A128GCM':case'A192GCM':case'A256GCM':{if(!o(h.algorithm,'AES-GCM'))throw t('AES-GCM');const s=parseInt(n.slice(1,4),10);if(h.algorithm.length!==s)throw t(s,'algorithm.length');break}case'A128KW':case'A192KW':case'A256KW':{if(!o(h.algorithm,'AES-KW'))throw t('AES-KW');const s=parseInt(n.slice(1,4),10);if(h.algorithm.length!==s)throw t(s,'algorithm.length');break}case'ECDH':switch(h.algorithm.name){case'ECDH':case'X25519':break;default:throw t('ECDH or X25519')}break;case'PBES2-HS256+A128KW':case'PBES2-HS384+A192KW':case'PBES2-HS512+A256KW':if(!o(h.algorithm,'PBKDF2'))throw t('PBKDF2');break;case'RSA-OAEP':case'RSA-OAEP-256':case'RSA-OAEP-384':case'RSA-OAEP-512':{if(!o(h.algorithm,'RSA-OAEP'))throw t('RSA-OAEP');const c=parseInt(n.slice(9),10)||1;if(s(h.algorithm.hash)!==c)throw t(`SHA-${c}`,'algorithm.hash');break}default:throw new TypeError('CryptoKey does not support this operation')}c(h,S)},e.checkSigCryptoKey=function(n,S,l){switch(S){case'HS256':case'HS384':case'HS512':{if(!o(n.algorithm,'HMAC'))throw t('HMAC');const h=parseInt(S.slice(2),10);if(s(n.algorithm.hash)!==h)throw t(`SHA-${h}`,'algorithm.hash');break}case'RS256':case'RS384':case'RS512':{if(!o(n.algorithm,'RSASSA-PKCS1-v1_5'))throw t('RSASSA-PKCS1-v1_5');const h=parseInt(S.slice(2),10);if(s(n.algorithm.hash)!==h)throw t(`SHA-${h}`,'algorithm.hash');break}case'PS256':case'PS384':case'PS512':{if(!o(n.algorithm,'RSA-PSS'))throw t('RSA-PSS');const h=parseInt(S.slice(2),10);if(s(n.algorithm.hash)!==h)throw t(`SHA-${h}`,'algorithm.hash');break}case'Ed25519':case'EdDSA':if(!o(n.algorithm,'Ed25519'))throw t('Ed25519');break;case'ML-DSA-44':case'ML-DSA-65':case'ML-DSA-87':if(!o(n.algorithm,S))throw t(S);break;case'ES256':case'ES384':case'ES512':{if(!o(n.algorithm,'ECDSA'))throw t('ECDSA');const s=h(S);if(n.algorithm.namedCurve!==s)throw t(s,'algorithm.namedCurve');break}default:throw new TypeError('CryptoKey does not support this operation')}c(n,l)};const t=(t,o="algorithm.name")=>new TypeError(`CryptoKey does not support this operation, its ${o} must be ${t}`),o=(t,o)=>t.name===o;function s(t){return parseInt(t.name.slice(4),10)}function h(t){switch(t){case'ES256':return'P-256';case'ES384':return'P-384';case'ES512':return'P-521';default:throw new Error('unreachable')}}function c(t,o){if(o&&!t.usages.includes(o))throw new TypeError(`CryptoKey does not support this operation, its usages must include ${o}.`)}},766,[]);
__d(function(g,r,i,a,m,e,d){function n(n,t,...o){if((o=o.filter(Boolean)).length>2){const t=o.pop();n+=`one of type ${o.join(', ')}, or ${t}.`}else 2===o.length?n+=`one of type ${o[0]} or ${o[1]}.`:n+=`of type ${o[0]}.`;return null==t?n+=` Received ${t}`:'function'==typeof t&&t.name?n+=` Received function ${t.name}`:'object'==typeof t&&null!=t&&t.constructor?.name&&(n+=` Received an instance of ${t.constructor.name}`),n}Object.defineProperty(e,"__esModule",{value:!0}),e.withAlg=e.invalidKeyInput=void 0;e.invalidKeyInput=(t,...o)=>n('Key must be ',t,...o);e.withAlg=(t,o,...l)=>n(`Key for the ${t} algorithm must be `,o,...l)},767,[]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.assertCryptoKey=function(y){if(!t(y))throw new Error('CryptoKey instance expected')},e.isKeyObject=e.isKeyLike=e.isCryptoKey=void 0;const t=t=>{if('CryptoKey'===t?.[Symbol.toStringTag])return!0;try{return t instanceof CryptoKey}catch{return!1}};e.isCryptoKey=t;const y=t=>'KeyObject'===t?.[Symbol.toStringTag];e.isKeyObject=y;e.isKeyLike=o=>t(o)||y(o)},768,[]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.isDisjoint=function(...t){const n=t.filter(Boolean);if(0===n.length||1===n.length)return!0;let o;for(const t of n){const n=Object.keys(t);if(o&&0!==o.size)for(const t of n){if(o.has(t))return!1;o.add(t)}else o=new Set(n)}return!0}},769,[]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.isObject=function(o){if(!t(o)||'[object Object]'!==Object.prototype.toString.call(o))return!1;if(null===Object.getPrototypeOf(o))return!0;let c=o;for(;null!==Object.getPrototypeOf(c);)c=Object.getPrototypeOf(c);return Object.getPrototypeOf(o)===c};const t=t=>'object'==typeof t&&null!==t},770,[]);
__d(function(g,_r,_i,a,m,_e,d){Object.defineProperty(_e,"__esModule",{value:!0}),_e.decryptKeyManagement=async function(u,w,v,y,f){switch(u){case'dir':if(void 0!==v)throw new o.JWEInvalid('Encountered unexpected JWE Encrypted Key');return w;case'ECDH-ES':if(void 0!==v)throw new o.JWEInvalid('Encountered unexpected JWE Encrypted Key');case'ECDH-ES+A128KW':case'ECDH-ES+A192KW':case'ECDH-ES+A256KW':{if(!(0,E.isObject)(y.epk))throw new o.JWEInvalid("JOSE Header \"epk\" (Ephemeral Public Key) missing or invalid");if((0,l.assertCryptoKey)(w),!t.allowed(w))throw new o.JOSENotSupported('ECDH with the provided key is not allowed or not supported by your javascript runtime');const n=await(0,s.importJWK)(y.epk,u);let i,p;if((0,l.assertCryptoKey)(n),void 0!==y.apu){if('string'!=typeof y.apu)throw new o.JWEInvalid("JOSE Header \"apu\" (Agreement PartyUInfo) invalid");try{i=(0,r.decode)(y.apu)}catch{throw new o.JWEInvalid('Failed to base64url decode the apu')}}if(void 0!==y.apv){if('string'!=typeof y.apv)throw new o.JWEInvalid("JOSE Header \"apv\" (Agreement PartyVInfo) invalid");try{p=(0,r.decode)(y.apv)}catch{throw new o.JWEInvalid('Failed to base64url decode the apv')}}const f=await t.deriveKey(n,w,'ECDH-ES'===u?y.enc:u,'ECDH-ES'===u?(0,c.cekLength)(y.enc):parseInt(u.slice(-5,-2),10),i,p);if('ECDH-ES'===u)return f;if(void 0===v)throw new o.JWEInvalid('JWE Encrypted Key missing');return e.unwrap(u.slice(-6),f,v)}case'RSA-OAEP':case'RSA-OAEP-256':case'RSA-OAEP-384':case'RSA-OAEP-512':if(void 0===v)throw new o.JWEInvalid('JWE Encrypted Key missing');return(0,l.assertCryptoKey)(w),i.decrypt(u,w,v);case'PBES2-HS256+A128KW':case'PBES2-HS384+A192KW':case'PBES2-HS512+A256KW':{if(void 0===v)throw new o.JWEInvalid('JWE Encrypted Key missing');if('number'!=typeof y.p2c)throw new o.JWEInvalid("JOSE Header \"p2c\" (PBES2 Count) missing or invalid");const e=f?.maxPBES2Count||1e4;if(y.p2c>e)throw new o.JWEInvalid("JOSE Header \"p2c\" (PBES2 Count) out is of acceptable bounds");if('string'!=typeof y.p2s)throw new o.JWEInvalid("JOSE Header \"p2s\" (PBES2 Salt) missing or invalid");let t;try{t=(0,r.decode)(y.p2s)}catch{throw new o.JWEInvalid('Failed to base64url decode the p2s')}return n.unwrap(u,w,v,y.p2c,t)}case'A128KW':case'A192KW':case'A256KW':if(void 0===v)throw new o.JWEInvalid('JWE Encrypted Key missing');return e.unwrap(u,w,v);case'A128GCMKW':case'A192GCMKW':case'A256GCMKW':{if(void 0===v)throw new o.JWEInvalid('JWE Encrypted Key missing');if('string'!=typeof y.iv)throw new o.JWEInvalid("JOSE Header \"iv\" (Initialization Vector) missing or invalid");if('string'!=typeof y.tag)throw new o.JWEInvalid("JOSE Header \"tag\" (Authentication Tag) missing or invalid");let e,t;try{e=(0,r.decode)(y.iv)}catch{throw new o.JWEInvalid('Failed to base64url decode the iv')}try{t=(0,r.decode)(y.tag)}catch{throw new o.JWEInvalid('Failed to base64url decode the tag')}return(0,p.unwrap)(u,w,v,e,t)}default:throw new o.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}};var e=u(_r(d[0])),t=u(_r(d[1])),n=u(_r(d[2])),i=u(_r(d[3])),r=_r(d[4]),o=_r(d[5]),c=_r(d[6]),s=_r(d[7]),E=_r(d[8]),p=_r(d[9]),l=_r(d[10]);function u(e,t){if("function"==typeof WeakMap)var n=new WeakMap,i=new WeakMap;return(u=function(e,t){if(!t&&e&&e.__esModule)return e;var r,o,c={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return c;if(r=t?i:n){if(r.has(e))return r.get(e);r.set(e,c)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((o=(r=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(o.get||o.set)?r(c,t,o):c[t]=e[t]);return c})(e,t)}},771,[772,773,775,776,758,763,778,779,770,782,768]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.unwrap=async function(t,c,y){const w=await o(c,t,'unwrapKey');n(w,t);const s=await crypto.subtle.unwrapKey('raw',y,w,'AES-KW',{hash:'SHA-256',name:'HMAC'},!0,['sign']);return new Uint8Array(await crypto.subtle.exportKey('raw',s))},e.wrap=async function(t,c,y){const w=await o(c,t,'wrapKey');n(w,t);const s=await crypto.subtle.importKey('raw',y,{hash:'SHA-256',name:'HMAC'},!0,['sign']);return new Uint8Array(await crypto.subtle.wrapKey('raw',s,w,'AES-KW'))};var t=r(d[0]);function n(t,n){if(t.algorithm.length!==parseInt(n.slice(1,4),10))throw new TypeError(`Invalid key size for alg: ${n}`)}function o(n,o,c){return n instanceof Uint8Array?crypto.subtle.importKey('raw',n,'AES-KW',!0,[c]):((0,t.checkEncCryptoKey)(n,o,c),n)}},772,[766]);
__d(function(g,r,_i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.allowed=function(t){switch(t.algorithm.namedCurve){case'P-256':case'P-384':case'P-521':return!0;default:return'X25519'===t.algorithm.name}},e.deriveKey=async function(i,u,l,h,y=new Uint8Array,w=new Uint8Array){(0,n.checkEncCryptoKey)(i,'ECDH'),(0,n.checkEncCryptoKey)(u,'ECDH','deriveBits');const f=c((0,t.encode)(l)),v=c(y),b=c(w),p=(0,t.uint32be)(h),A=new Uint8Array,C=(0,t.concat)(f,v,b,p,A);return o(new Uint8Array(await crypto.subtle.deriveBits({name:i.algorithm.name,public:i},u,s(i))),h,C)};var t=r(d[0]),n=r(d[1]),i=r(d[2]);function c(n){return(0,t.concat)((0,t.uint32be)(n.length),n)}async function o(n,c,o){const s=c>>3,u=Math.ceil(s/32),l=new Uint8Array(32*u);for(let c=1;c<=u;c++){const s=new Uint8Array(4+n.length+o.length);s.set((0,t.uint32be)(c),0),s.set(n,4),s.set(o,4+n.length);const u=await(0,i.digest)('sha256',s);l.set(u,32*(c-1))}return l.slice(0,s)}function s(t){return'X25519'===t.algorithm.name?256:Math.ceil(parseInt(t.algorithm.namedCurve.slice(-3),10)/8)<<3}},773,[759,766,774]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.digest=async function(t,n){const c=`SHA-${t.slice(-3)}`;return new Uint8Array(await crypto.subtle.digest(c,n))}},774,[]);
__d(function(g,_r,_i,a,m,_e,d){Object.defineProperty(_e,"__esModule",{value:!0}),_e.unwrap=async function(t,n,r,i,o){const c=await s(o,t,i,n);return e.unwrap(t.slice(-6),c,r)},_e.wrap=async function(n,r,i,o=2048,c=crypto.getRandomValues(new Uint8Array(16))){const u=await s(c,n,o,r);return{encryptedKey:await e.wrap(n.slice(-6),u,i),p2c:o,p2s:(0,t.encode)(c)}};var t=_r(d[0]),e=(function(t,e){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(function(t,e){if(!e&&t&&t.__esModule)return t;var i,o,c={__proto__:null,default:t};if(null===t||"object"!=typeof t&&"function"!=typeof t)return c;if(i=e?r:n){if(i.has(t))return i.get(t);i.set(t,c)}for(const e in t)"default"!==e&&{}.hasOwnProperty.call(t,e)&&((o=(i=Object.defineProperty)&&Object.getOwnPropertyDescriptor(t,e))&&(o.get||o.set)?i(c,e,o):c[e]=t[e]);return c})(t,e)})(_r(d[1])),n=_r(d[2]),r=_r(d[3]),i=_r(d[4]);function o(t,e){return t instanceof Uint8Array?crypto.subtle.importKey('raw',t,'PBKDF2',!1,['deriveBits']):((0,n.checkEncCryptoKey)(t,e,'deriveBits'),t)}const c=(t,e)=>(0,r.concat)((0,r.encode)(t),Uint8Array.of(0),e);async function s(t,e,n,r){if(!(t instanceof Uint8Array)||t.length<8)throw new i.JWEInvalid('PBES2 Salt Input must be 8 or more octets');const s=c(e,t),u=parseInt(e.slice(13,16),10),f={hash:`SHA-${e.slice(8,11)}`,iterations:n,name:'PBKDF2',salt:s},p=await o(r,e);return new Uint8Array(await crypto.subtle.deriveBits(f,p,u))}},775,[758,772,766,759,763]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.decrypt=async function(n,o,p){return(0,t.checkEncCryptoKey)(o,n,'decrypt'),(0,c.checkKeyLength)(n,o),new Uint8Array(await crypto.subtle.decrypt(y(n),o,p))},e.encrypt=async function(n,o,p){return(0,t.checkEncCryptoKey)(o,n,'encrypt'),(0,c.checkKeyLength)(n,o),new Uint8Array(await crypto.subtle.encrypt(y(n),o,p))};var t=r(d[0]),c=r(d[1]),n=r(d[2]);const y=t=>{switch(t){case'RSA-OAEP':case'RSA-OAEP-256':case'RSA-OAEP-384':case'RSA-OAEP-512':return'RSA-OAEP';default:throw new n.JOSENotSupported(`alg ${t} is not supported either by JOSE or your javascript runtime`)}}},776,[766,777,763]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.checkKeyLength=function(t,o){if(t.startsWith('RS')||t.startsWith('PS')){const{modulusLength:n}=o.algorithm;if('number'!=typeof n||n<2048)throw new TypeError(`${t} requires key modulusLength to be 2048 bits or larger`)}}},777,[]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.cekLength=n,e.generateCek=void 0;var t=r(d[0]);function n(n){switch(n){case'A128GCM':return 128;case'A192GCM':return 192;case'A256GCM':case'A128CBC-HS256':return 256;case'A192CBC-HS384':return 384;case'A256CBC-HS512':return 512;default:throw new t.JOSENotSupported(`Unsupported JWE Algorithm: ${n}`)}}e.generateCek=t=>crypto.getRandomValues(new Uint8Array(n(t)>>3))},778,[763]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.importJWK=async function(o,p,u){if(!(0,f.isObject)(o))throw new TypeError('JWK must be an object');let y;switch(p??=o.alg,y??=u?.extractable??o.ext,o.kty){case'oct':if('string'!=typeof o.k||!o.k)throw new TypeError('missing "k" (Key Value) Parameter value');return(0,t.decode)(o.k);case'RSA':if('oth'in o&&void 0!==o.oth)throw new s.JOSENotSupported('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');return(0,n.jwkToKey)({...o,alg:p,ext:y});case'AKP':if('string'!=typeof o.alg||!o.alg)throw new TypeError('missing "alg" (Algorithm) Parameter value');if(void 0!==p&&p!==o.alg)throw new TypeError('JWK alg and alg option value mismatch');return(0,n.jwkToKey)({...o,ext:y});case'EC':case'OKP':return(0,n.jwkToKey)({...o,alg:p,ext:y});default:throw new s.JOSENotSupported('Unsupported "kty" (Key Type) Parameter value')}},e.importPKCS8=async function(t,n,s){if('string'!=typeof t||0!==t.indexOf('-----BEGIN PRIVATE KEY-----'))throw new TypeError('"pkcs8" must be PKCS#8 formatted string');return(0,o.fromPKCS8)(t,n,s)},e.importSPKI=async function(t,n,s){if('string'!=typeof t||0!==t.indexOf('-----BEGIN PUBLIC KEY-----'))throw new TypeError('"spki" must be SPKI formatted string');return(0,o.fromSPKI)(t,n,s)},e.importX509=async function(t,n,s){if('string'!=typeof t||0!==t.indexOf('-----BEGIN CERTIFICATE-----'))throw new TypeError('"x509" must be X.509 formatted string');return(0,o.fromX509)(t,n,s)};var t=r(d[0]),o=r(d[1]),n=r(d[2]),s=r(d[3]),f=r(d[4])},779,[758,780,781,763,770]);
__d(function(g,r,_i,_a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.toSPKI=e.toPKCS8=e.fromX509=e.fromSPKI=e.fromPKCS8=void 0;var t=r(d[0]),a=r(d[1]),n=r(d[2]),o=r(d[3]);const s=(t,a)=>`-----BEGIN ${a}-----\n${(t.match(/.{1,64}/g)||[]).join('\n')}\n-----END ${a}-----`,c=async(n,c,i)=>{if((0,o.isKeyObject)(i)){if(i.type!==n)throw new TypeError(`key is not a ${n} key`);return i.export({format:'pem',type:c})}if(!(0,o.isCryptoKey)(i))throw new TypeError((0,t.invalidKeyInput)(i,'CryptoKey','KeyObject'));if(!i.extractable)throw new TypeError('CryptoKey is not extractable');if(i.type!==n)throw new TypeError(`key is not a ${n} key`);return s((0,a.encodeBase64)(new Uint8Array(await crypto.subtle.exportKey(c,i))),`${n.toUpperCase()} KEY`)};e.toSPKI=t=>c('public','spki',t);e.toPKCS8=t=>c('private','pkcs8',t);const i=(t,a)=>{if(t.byteLength!==a.length)return!1;for(let n=0;n<t.byteLength;n++)if(t[n]!==a[n])return!1;return!0},p=t=>({data:t,pos:0}),u=t=>{const a=t.data[t.pos++];if(128&a){const n=127&a;let o=0;for(let a=0;a<n;a++)o=o<<8|t.data[t.pos++];return o}return a},E=(t,a=1)=>{if(a<=0)return;t.pos++;const n=u(t);t.pos+=n,a>1&&E(t,a-1)},S=(t,a,n)=>{if(t.data[t.pos++]!==a)throw new Error(n)},l=(t,a)=>{const n=t.data.subarray(t.pos,t.pos+a);return t.pos+=a,n},y=t=>{S(t,6,'Expected algorithm OID');const a=u(t);return l(t,a)};function f(t){S(t,48,'Invalid PKCS#8 structure'),u(t),S(t,2,'Expected version field');const a=u(t);t.pos+=a,S(t,48,'Expected algorithm identifier');const n=u(t);return{algIdStart:t.pos,algIdLength:n}}function h(t){S(t,48,'Invalid SPKI structure'),u(t),S(t,48,'Expected algorithm identifier');const a=u(t);return{algIdStart:t.pos,algIdLength:a}}const P=t=>{const a=y(t);if(i(a,[43,101,110]))return'X25519';if(!i(a,[42,134,72,206,61,2,1]))throw new Error('Unsupported key algorithm');S(t,6,'Expected curve OID');const n=u(t),o=l(t,n);for(const{name:t,oid:a}of[{name:'P-256',oid:[42,134,72,206,61,3,1,7]},{name:'P-384',oid:[43,129,4,0,34]},{name:'P-521',oid:[43,129,4,0,35]}])if(i(o,a))return t;throw new Error('Unsupported named curve')},I=async(t,a,o,s)=>{let c,i;const p='spki'===t,u=()=>p?['verify']:['sign'];switch(o){case'PS256':case'PS384':case'PS512':c={name:'RSA-PSS',hash:`SHA-${o.slice(-3)}`},i=u();break;case'RS256':case'RS384':case'RS512':c={name:'RSASSA-PKCS1-v1_5',hash:`SHA-${o.slice(-3)}`},i=u();break;case'RSA-OAEP':case'RSA-OAEP-256':case'RSA-OAEP-384':case'RSA-OAEP-512':c={name:'RSA-OAEP',hash:`SHA-${parseInt(o.slice(-3),10)||1}`},i=p?['encrypt','wrapKey']:['decrypt','unwrapKey'];break;case'ES256':case'ES384':case'ES512':c={name:'ECDSA',namedCurve:{ES256:'P-256',ES384:'P-384',ES512:'P-521'}[o]},i=u();break;case'ECDH-ES':case'ECDH-ES+A128KW':case'ECDH-ES+A192KW':case'ECDH-ES+A256KW':try{const t=s.getNamedCurve(a);c='X25519'===t?{name:'X25519'}:{name:'ECDH',namedCurve:t}}catch(t){throw new n.JOSENotSupported('Invalid or unsupported key format')}i=p?[]:['deriveBits'];break;case'Ed25519':case'EdDSA':c={name:'Ed25519'},i=u();break;case'ML-DSA-44':case'ML-DSA-65':case'ML-DSA-87':c={name:o},i=u();break;default:throw new n.JOSENotSupported('Invalid or unsupported "alg" (Algorithm) value')}return crypto.subtle.importKey(t,a,c,s?.extractable??!!p,i)},K=(t,n)=>(0,a.decodeBase64)(t.replace(n,''));e.fromPKCS8=(t,a,n)=>{const o=K(t,/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g);let s=n;return a?.startsWith?.('ECDH-ES')&&(s||={},s.getNamedCurve=t=>{const a=p(t);return f(a),P(a)}),I('pkcs8',o,a,s)};const A=(t,a,n)=>{const o=K(t,/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g);let s=n;return a?.startsWith?.('ECDH-ES')&&(s||={},s.getNamedCurve=t=>{const a=p(t);return h(a),P(a)}),I('spki',o,a,s)};function C(t){const a=p(t);S(a,48,'Invalid certificate structure'),u(a),S(a,48,'Invalid tbsCertificate structure'),u(a),160===t[a.pos]?E(a,6):E(a,5);const n=a.pos;S(a,48,'Invalid SPKI structure');const o=u(a);return t.subarray(n,n+o+(a.pos-n))}e.fromSPKI=A;e.fromX509=(t,n,o)=>{let c;try{c=C(K(t,/(?:-----(?:BEGIN|END) CERTIFICATE-----|\s)/g))}catch(t){throw new TypeError('Failed to parse the X.509 certificate',{cause:t})}return A(s((0,a.encodeBase64)(c),'PUBLIC KEY'),n,o)}},780,[767,760,763,768]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.jwkToKey=async function(s){if(!s.alg)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');const{algorithm:n,keyUsages:S}=t(s),c={...s};'AKP'!==c.kty&&delete c.alg;return delete c.use,crypto.subtle.importKey('jwk',c,n,s.ext??(!s.d&&!s.priv),s.key_ops??S)};var s=r(d[0]);function t(t){let n,S;switch(t.kty){case'AKP':switch(t.alg){case'ML-DSA-44':case'ML-DSA-65':case'ML-DSA-87':n={name:t.alg},S=t.priv?['sign']:['verify'];break;default:throw new s.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case'RSA':switch(t.alg){case'PS256':case'PS384':case'PS512':n={name:'RSA-PSS',hash:`SHA-${t.alg.slice(-3)}`},S=t.d?['sign']:['verify'];break;case'RS256':case'RS384':case'RS512':n={name:'RSASSA-PKCS1-v1_5',hash:`SHA-${t.alg.slice(-3)}`},S=t.d?['sign']:['verify'];break;case'RSA-OAEP':case'RSA-OAEP-256':case'RSA-OAEP-384':case'RSA-OAEP-512':n={name:'RSA-OAEP',hash:`SHA-${parseInt(t.alg.slice(-3),10)||1}`},S=t.d?['decrypt','unwrapKey']:['encrypt','wrapKey'];break;default:throw new s.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case'EC':switch(t.alg){case'ES256':n={name:'ECDSA',namedCurve:'P-256'},S=t.d?['sign']:['verify'];break;case'ES384':n={name:'ECDSA',namedCurve:'P-384'},S=t.d?['sign']:['verify'];break;case'ES512':n={name:'ECDSA',namedCurve:'P-521'},S=t.d?['sign']:['verify'];break;case'ECDH-ES':case'ECDH-ES+A128KW':case'ECDH-ES+A192KW':case'ECDH-ES+A256KW':n={name:'ECDH',namedCurve:t.crv},S=t.d?['deriveBits']:[];break;default:throw new s.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case'OKP':switch(t.alg){case'Ed25519':case'EdDSA':n={name:'Ed25519'},S=t.d?['sign']:['verify'];break;case'ECDH-ES':case'ECDH-ES+A128KW':case'ECDH-ES+A192KW':case'ECDH-ES+A256KW':n={name:t.crv},S=t.d?['deriveBits']:[];break;default:throw new s.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;default:throw new s.JOSENotSupported('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:n,keyUsages:S}}},781,[763]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.unwrap=async function(n,c,o,y,u){const p=n.slice(0,7);return(0,t.decrypt)(p,c,o,y,u,new Uint8Array)},e.wrap=async function(t,o,y,u){const p=t.slice(0,7),s=await(0,n.encrypt)(p,y,o,u,new Uint8Array);return{encryptedKey:s.ciphertext,iv:(0,c.encode)(s.iv),tag:(0,c.encode)(s.tag)}};var n=r(d[0]),t=r(d[1]),c=r(d[2])},782,[783,761,758]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.encrypt=async function(t,y,l,w,h){if(!((0,u.isCryptoKey)(l)||l instanceof Uint8Array))throw new TypeError((0,s.invalidKeyInput)(l,'CryptoKey','KeyObject','Uint8Array','JSON Web Key'));w?(0,n.checkIvLength)(t,w):w=(0,o.generateIv)(t);switch(t){case'A128CBC-HS256':case'A192CBC-HS384':case'A256CBC-HS512':return l instanceof Uint8Array&&(0,c.checkCekLength)(l,parseInt(t.slice(-3),10)),A(t,y,l,w,h);case'A128GCM':case'A192GCM':case'A256GCM':return l instanceof Uint8Array&&(0,c.checkCekLength)(l,parseInt(t.slice(1,4),10)),C(t,y,l,w,h);default:throw new p.JOSENotSupported('Unsupported JWE Content Encryption Algorithm')}};var t=r(d[0]),n=r(d[1]),c=r(d[2]),y=r(d[3]),s=r(d[4]),o=r(d[5]),p=r(d[6]),u=r(d[7]);async function A(n,c,y,o,p){if(!(y instanceof Uint8Array))throw new TypeError((0,s.invalidKeyInput)(y,'Uint8Array'));const u=parseInt(n.slice(1,4),10),A=await crypto.subtle.importKey('raw',y.subarray(u>>3),'AES-CBC',!1,['encrypt']),C=await crypto.subtle.importKey('raw',y.subarray(0,u>>3),{hash:"SHA-"+(u<<1),name:'HMAC'},!1,['sign']),l=new Uint8Array(await crypto.subtle.encrypt({iv:o,name:'AES-CBC'},A,c)),w=(0,t.concat)(p,o,l,(0,t.uint64be)(p.length<<3));return{ciphertext:l,tag:new Uint8Array((await crypto.subtle.sign('HMAC',C,w)).slice(0,u>>3)),iv:o}}async function C(t,n,c,s,o){let p;c instanceof Uint8Array?p=await crypto.subtle.importKey('raw',c,'AES-GCM',!1,['encrypt']):((0,y.checkEncCryptoKey)(c,t,'encrypt'),p=c);const u=new Uint8Array(await crypto.subtle.encrypt({additionalData:o,iv:s,name:'AES-GCM',tagLength:128},p,n)),A=u.slice(-16);return{ciphertext:u.slice(0,-16),tag:A,iv:s}}},783,[759,762,765,766,767,764,763,768]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.validateCrit=function(n,o,c,s,w){if(void 0!==w.crit&&void 0===s?.crit)throw new n('"crit" (Critical) Header Parameter MUST be integrity protected');if(!s||void 0===s.crit)return new Set;if(!Array.isArray(s.crit)||0===s.crit.length||s.crit.some(t=>'string'!=typeof t||0===t.length))throw new n('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let f;f=void 0!==c?new Map([...Object.entries(c),...o.entries()]):o;for(const o of s.crit){if(!f.has(o))throw new t.JOSENotSupported(`Extension Header Parameter "${o}" is not recognized`);if(void 0===w[o])throw new n(`Extension Header Parameter "${o}" is missing`);if(f.get(o)&&void 0===s[o])throw new n(`Extension Header Parameter "${o}" MUST be integrity protected`)}return new Set(s.crit)};var t=r(d[0])},784,[763]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.validateAlgorithms=function(t,n){if(void 0!==n&&(!Array.isArray(n)||n.some(t=>'string'!=typeof t)))throw new TypeError(`"${t}" option must be an array of strings`);if(!n)return;return new Set(n)}},785,[]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.normalizeKey=async function(s,o){if(s instanceof Uint8Array)return s;if((0,y.isCryptoKey)(s))return s;if((0,y.isKeyObject)(s)){if('secret'===s.type)return s.export();if('toCryptoKey'in s&&'function'==typeof s.toCryptoKey)try{return p(s,o)}catch(t){if(t instanceof TypeError)throw t}let t=s.export({format:'jwk'});return c(s,t,o)}if((0,t.isJWK)(s))return s.k?(0,n.decode)(s.k):c(s,s,o,!0);throw new Error('unreachable')};var t=r(d[0]),n=r(d[1]),s=r(d[2]),y=r(d[3]);let o;const c=async(t,n,y,c=!1)=>{o||=new WeakMap;let p=o.get(t);if(p?.[y])return p[y];const f=await(0,s.jwkToKey)({...n,alg:y});return c&&Object.freeze(t),p?p[y]=f:o.set(t,{[y]:f}),f},p=(t,n)=>{o||=new WeakMap;let s=o.get(t);if(s?.[n])return s[n];const y='public'===t.type,c=!!y;let p;if('x25519'===t.asymmetricKeyType){switch(n){case'ECDH-ES':case'ECDH-ES+A128KW':case'ECDH-ES+A192KW':case'ECDH-ES+A256KW':break;default:throw new TypeError('given KeyObject instance cannot be used for this algorithm')}p=t.toCryptoKey(t.asymmetricKeyType,c,y?[]:['deriveBits'])}if('ed25519'===t.asymmetricKeyType){if('EdDSA'!==n&&'Ed25519'!==n)throw new TypeError('given KeyObject instance cannot be used for this algorithm');p=t.toCryptoKey(t.asymmetricKeyType,c,[y?'verify':'sign'])}switch(t.asymmetricKeyType){case'ml-dsa-44':case'ml-dsa-65':case'ml-dsa-87':if(n!==t.asymmetricKeyType.toUpperCase())throw new TypeError('given KeyObject instance cannot be used for this algorithm');p=t.toCryptoKey(t.asymmetricKeyType,c,[y?'verify':'sign'])}if('rsa'===t.asymmetricKeyType){let s;switch(n){case'RSA-OAEP':s='SHA-1';break;case'RS256':case'PS256':case'RSA-OAEP-256':s='SHA-256';break;case'RS384':case'PS384':case'RSA-OAEP-384':s='SHA-384';break;case'RS512':case'PS512':case'RSA-OAEP-512':s='SHA-512';break;default:throw new TypeError('given KeyObject instance cannot be used for this algorithm')}if(n.startsWith('RSA-OAEP'))return t.toCryptoKey({name:'RSA-OAEP',hash:s},c,y?['encrypt']:['decrypt']);p=t.toCryptoKey({name:n.startsWith('PS')?'RSA-PSS':'RSASSA-PKCS1-v1_5',hash:s},c,[y?'verify':'sign'])}if('ec'===t.asymmetricKeyType){const s=new Map([['prime256v1','P-256'],['secp384r1','P-384'],['secp521r1','P-521']]).get(t.asymmetricKeyDetails?.namedCurve);if(!s)throw new TypeError('given KeyObject instance cannot be used for this algorithm');'ES256'===n&&'P-256'===s&&(p=t.toCryptoKey({name:'ECDSA',namedCurve:s},c,[y?'verify':'sign'])),'ES384'===n&&'P-384'===s&&(p=t.toCryptoKey({name:'ECDSA',namedCurve:s},c,[y?'verify':'sign'])),'ES512'===n&&'P-521'===s&&(p=t.toCryptoKey({name:'ECDSA',namedCurve:s},c,[y?'verify':'sign'])),n.startsWith('ECDH-ES')&&(p=t.toCryptoKey({name:'ECDH',namedCurve:s},c,y?[]:['deriveBits']))}if(!p)throw new TypeError('given KeyObject instance cannot be used for this algorithm');return s?s[n]=p:o.set(t,{[n]:p}),p}},786,[787,758,781,768]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.isSecretJWK=e.isPublicJWK=e.isPrivateJWK=e.isJWK=void 0;var t=r(d[0]);e.isJWK=s=>(0,t.isObject)(s)&&'string'==typeof s.kty;e.isPrivateJWK=t=>'oct'!==t.kty&&('AKP'===t.kty&&'string'==typeof t.priv||'string'==typeof t.d);e.isPublicJWK=t=>'oct'!==t.kty&&void 0===t.d&&void 0===t.priv;e.isSecretJWK=t=>'oct'===t.kty&&'string'==typeof t.k},787,[770]);
__d(function(g,_r,_i,a,m,_e,d){Object.defineProperty(_e,"__esModule",{value:!0}),_e.checkKeyType=function(e,r,t){switch(e.substring(0,2)){case'A1':case'A2':case'di':case'HS':case'PB':n(e,r,t);break;default:o(e,r,t)}};var e=_r(d[0]),r=_r(d[1]),t=(function(e,r){if("function"==typeof WeakMap)var t=new WeakMap,i=new WeakMap;return(function(e,r){if(!r&&e&&e.__esModule)return e;var s,n,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(s=r?i:t){if(s.has(e))return s.get(e);s.set(e,o)}for(const r in e)"default"!==r&&{}.hasOwnProperty.call(e,r)&&((n=(s=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,r))&&(n.get||n.set)?s(o,r,n):o[r]=e[r]);return o})(e,r)})(_r(d[2]));const i=e=>e?.[Symbol.toStringTag],s=(e,r,t)=>{if(void 0!==r.use){let e;switch(t){case'sign':case'verify':e='sig';break;case'encrypt':case'decrypt':e='enc'}if(r.use!==e)throw new TypeError(`Invalid key for this operation, its "use" must be "${e}" when present`)}if(void 0!==r.alg&&r.alg!==e)throw new TypeError(`Invalid key for this operation, its "alg" must be "${e}" when present`);if(Array.isArray(r.key_ops)){let i;switch(!0){case'sign'===t||'verify'===t:case'dir'===e:case e.includes('CBC-HS'):i=t;break;case e.startsWith('PBES2'):i='deriveBits';break;case/^A\d{3}(?:GCM)?(?:KW)?$/.test(e):i=!e.includes('GCM')&&e.endsWith('KW')?'encrypt'===t?'wrapKey':'unwrapKey':t;break;case'encrypt'===t&&e.startsWith('RSA'):i='wrapKey';break;case'decrypt'===t:i=e.startsWith('RSA')?'unwrapKey':'deriveBits'}if(i&&!1===r.key_ops?.includes?.(i))throw new TypeError(`Invalid key for this operation, its "key_ops" must include "${i}" when present`)}return!0},n=(n,o,c)=>{if(!(o instanceof Uint8Array)){if(t.isJWK(o)){if(t.isSecretJWK(o)&&s(n,o,c))return;throw new TypeError("JSON Web Key for symmetric algorithms must have JWK \"kty\" (Key Type) equal to \"oct\" and the JWK \"k\" (Key Value) present")}if(!(0,r.isKeyLike)(o))throw new TypeError((0,e.withAlg)(n,o,'CryptoKey','KeyObject','JSON Web Key','Uint8Array'));if('secret'!==o.type)throw new TypeError(`${i(o)} instances for symmetric algorithms must be of type "secret"`)}},o=(n,o,c)=>{if(t.isJWK(o))switch(c){case'decrypt':case'sign':if(t.isPrivateJWK(o)&&s(n,o,c))return;throw new TypeError("JSON Web Key for this operation be a private JWK");case'encrypt':case'verify':if(t.isPublicJWK(o)&&s(n,o,c))return;throw new TypeError("JSON Web Key for this operation be a public JWK")}if(!(0,r.isKeyLike)(o))throw new TypeError((0,e.withAlg)(n,o,'CryptoKey','KeyObject','JSON Web Key'));if('secret'===o.type)throw new TypeError(`${i(o)} instances for asymmetric algorithms must not be of type "secret"`);if('public'===o.type)switch(c){case'sign':throw new TypeError(`${i(o)} instances for asymmetric algorithm signing must be of type "private"`);case'decrypt':throw new TypeError(`${i(o)} instances for asymmetric algorithm decryption must be of type "private"`)}if('private'===o.type)switch(c){case'verify':throw new TypeError(`${i(o)} instances for asymmetric algorithm verifying must be of type "public"`);case'encrypt':throw new TypeError(`${i(o)} instances for asymmetric algorithm encryption must be of type "public"`)}}},788,[767,768,787]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.generalDecrypt=async function(o,p,s){if(!(0,c.isObject)(o))throw new n.JWEInvalid('General JWE must be an object');if(!Array.isArray(o.recipients)||!o.recipients.every(c.isObject))throw new n.JWEInvalid('JWE Recipients missing or incorrect type');if(!o.recipients.length)throw new n.JWEInvalid('JWE Recipients has no members');for(const n of o.recipients)try{return await(0,t.flattenedDecrypt)({aad:o.aad,ciphertext:o.ciphertext,encrypted_key:n.encrypted_key,header:n.header,iv:o.iv,protected:o.protected,tag:o.tag,unprotected:o.unprotected},p,s)}catch{}throw new n.JWEDecryptionFailed};var t=r(d[0]),n=r(d[1]),c=r(d[2])},789,[757,763,770]);
__d(function(g,r,_i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.GeneralEncrypt=void 0;var t=r(d[0]),n=r(d[1]),i=r(d[2]),c=r(d[3]),o=r(d[4]),s=r(d[5]),p=r(d[6]),h=r(d[7]),l=r(d[8]),y=r(d[9]);class u{#e;constructor(t,n,i){this.#e=t,this.key=n,this.options=i}setUnprotectedHeader(t){if(this.unprotectedHeader)throw new TypeError('setUnprotectedHeader can only be called once');return this.unprotectedHeader=t,this}setKeyManagementParameters(t){if(this.keyManagementParameters)throw new TypeError('setKeyManagementParameters can only be called once');return this.keyManagementParameters=t,this}addRecipient(...t){return this.#e.addRecipient(...t)}encrypt(...t){return this.#e.encrypt(...t)}done(){return this.#e}}e.GeneralEncrypt=class{#t;#r=[];#n;#a;#i;constructor(t){this.#t=t}addRecipient(t,n){const i=new u(this,t,{crit:n?.crit});return this.#r.push(i),i}setProtectedHeader(t){if(this.#n)throw new TypeError('setProtectedHeader can only be called once');return this.#n=t,this}setSharedUnprotectedHeader(t){if(this.#a)throw new TypeError('setSharedUnprotectedHeader can only be called once');return this.#a=t,this}setAdditionalAuthenticatedData(t){return this.#i=t,this}async encrypt(){if(!this.#r.length)throw new i.JWEInvalid('at least one recipient must be added');if(1===this.#r.length){const[n]=this.#r,i=await new t.FlattenedEncrypt(this.#t).setAdditionalAuthenticatedData(this.#i).setProtectedHeader(this.#n).setSharedUnprotectedHeader(this.#a).setUnprotectedHeader(n.unprotectedHeader).encrypt(n.key,{...n.options}),c={ciphertext:i.ciphertext,iv:i.iv,recipients:[{}],tag:i.tag};return i.aad&&(c.aad=i.aad),i.protected&&(c.protected=i.protected),i.unprotected&&(c.unprotected=i.unprotected),i.encrypted_key&&(c.recipients[0].encrypted_key=i.encrypted_key),i.header&&(c.recipients[0].header=i.header),c}let u;for(let t=0;t<this.#r.length;t++){const n=this.#r[t];if(!(0,o.isDisjoint)(this.#n,this.#a,n.unprotectedHeader))throw new i.JWEInvalid('JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint');const c={...this.#n,...this.#a,...n.unprotectedHeader},{alg:s}=c;if('string'!=typeof s||!s)throw new i.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if('dir'===s||'ECDH-ES'===s)throw new i.JWEInvalid('"dir" and "ECDH-ES" alg may only be used with a single recipient');if('string'!=typeof c.enc||!c.enc)throw new i.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(u){if(u!==c.enc)throw new i.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients')}else u=c.enc;if((0,h.validateCrit)(i.JWEInvalid,new Map,n.options.crit,this.#n,c),void 0!==c.zip)throw new i.JOSENotSupported('JWE "zip" (Compression Algorithm) Header Parameter is not supported.')}const H=(0,c.generateCek)(u),w={ciphertext:'',recipients:[]};for(let i=0;i<this.#r.length;i++){const c=this.#r[i],o={};if(w.recipients.push(o),0===i){const i=await new t.FlattenedEncrypt(this.#t).setAdditionalAuthenticatedData(this.#i).setContentEncryptionKey(H).setProtectedHeader(this.#n).setSharedUnprotectedHeader(this.#a).setUnprotectedHeader(c.unprotectedHeader).setKeyManagementParameters(c.keyManagementParameters).encrypt(c.key,{...c.options,[n.unprotected]:!0});w.ciphertext=i.ciphertext,w.iv=i.iv,w.tag=i.tag,i.aad&&(w.aad=i.aad),i.protected&&(w.protected=i.protected),i.unprotected&&(w.unprotected=i.unprotected),o.encrypted_key=i.encrypted_key,i.header&&(o.header=i.header);continue}const h=c.unprotectedHeader?.alg||this.#n?.alg||this.#a?.alg;(0,y.checkKeyType)('dir'===h?u:h,c.key,'encrypt');const E=await(0,l.normalizeKey)(c.key,h),{encryptedKey:f,parameters:P}=await(0,s.encryptKeyManagement)(h,u,E,H,c.keyManagementParameters);o.encrypted_key=(0,p.encode)(f),(c.unprotectedHeader||P)&&(o.header={...c.unprotectedHeader,...P})}return w}}},790,[791,792,763,778,769,793,758,784,786,788]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.FlattenedEncrypt=void 0;var t=r(d[0]),n=r(d[1]),o=r(d[2]),c=r(d[3]),s=r(d[4]),h=r(d[5]),p=r(d[6]),l=r(d[7]),y=r(d[8]),H=r(d[9]);e.FlattenedEncrypt=class{#e;#t;#r;#n;#a;#d;#i;#o;constructor(t){if(!(t instanceof Uint8Array))throw new TypeError('plaintext must be an instance of Uint8Array');this.#e=t}setKeyManagementParameters(t){if(this.#o)throw new TypeError('setKeyManagementParameters can only be called once');return this.#o=t,this}setProtectedHeader(t){if(this.#t)throw new TypeError('setProtectedHeader can only be called once');return this.#t=t,this}setSharedUnprotectedHeader(t){if(this.#r)throw new TypeError('setSharedUnprotectedHeader can only be called once');return this.#r=t,this}setUnprotectedHeader(t){if(this.#n)throw new TypeError('setUnprotectedHeader can only be called once');return this.#n=t,this}setAdditionalAuthenticatedData(t){return this.#a=t,this}setContentEncryptionKey(t){if(this.#d)throw new TypeError('setContentEncryptionKey can only be called once');return this.#d=t,this}setInitializationVector(t){if(this.#i)throw new TypeError('setInitializationVector can only be called once');return this.#i=t,this}async encrypt(w,u){if(!this.#t&&!this.#n&&!this.#r)throw new s.JWEInvalid('either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()');if(!(0,h.isDisjoint)(this.#t,this.#n,this.#r))throw new s.JWEInvalid('JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint');const E={...this.#t,...this.#n,...this.#r};if((0,l.validateCrit)(s.JWEInvalid,new Map,u?.crit,this.#t,E),void 0!==E.zip)throw new s.JOSENotSupported('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');const{alg:f,enc:U}=E;if('string'!=typeof f||!f)throw new s.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if('string'!=typeof U||!U)throw new s.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');let v,P,J,b,k,W;if(this.#d&&('dir'===f||'ECDH-ES'===f))throw new TypeError(`setContentEncryptionKey cannot be called with JWE "alg" (Algorithm) Header ${f}`);(0,H.checkKeyType)('dir'===f?U:f,w,'encrypt');{let t;const o=await(0,y.normalizeKey)(w,f);({cek:P,encryptedKey:v,parameters:t}=await(0,c.encryptKeyManagement)(f,U,o,this.#d,this.#o)),t&&(u&&n.unprotected in u?this.#n?this.#n={...this.#n,...t}:this.setUnprotectedHeader(t):this.#t?this.#t={...this.#t,...t}:this.setProtectedHeader(t))}if(this.#t?(b=(0,t.encode)(JSON.stringify(this.#t)),k=(0,p.encode)(b)):(b='',k=new Uint8Array),this.#a){W=(0,t.encode)(this.#a);const n=(0,p.encode)(W);J=(0,p.concat)(k,(0,p.encode)('.'),n)}else J=k;const{ciphertext:A,tag:K,iv:M}=await(0,o.encrypt)(U,this.#e,P,this.#i,J),T={ciphertext:(0,t.encode)(A)};return M&&(T.iv=(0,t.encode)(M)),K&&(T.tag=(0,t.encode)(K)),v&&(T.encrypted_key=(0,t.encode)(v)),W&&(T.aad=W),this.#t&&(T.protected=b),this.#r&&(T.unprotected=this.#r),this.#n&&(T.header=this.#n),T}}},791,[758,792,783,793,763,769,759,784,786,788]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.unprotected=void 0;e.unprotected=Symbol()},792,[]);
__d(function(g,_r,_i,a,m,_e,d){Object.defineProperty(_e,"__esModule",{value:!0}),_e.encryptKeyManagement=async function(l,E,w,k,K={}){let f,A,S;switch(l){case'dir':S=w;break;case'ECDH-ES':case'ECDH-ES+A128KW':case'ECDH-ES+A192KW':case'ECDH-ES+A256KW':{if((0,u.assertCryptoKey)(w),!t.allowed(w))throw new s.JOSENotSupported('ECDH with the provided key is not allowed or not supported by your javascript runtime');const{apu:r,apv:n}=K;let y;y=K.epk?await(0,o.normalizeKey)(K.epk,l):(await crypto.subtle.generateKey(w.algorithm,!0,['deriveBits'])).privateKey;const{x:C,y:W,crv:v,kty:b}=await(0,i.exportJWK)(y),h=await t.deriveKey(w,y,'ECDH-ES'===l?E:l,'ECDH-ES'===l?(0,p.cekLength)(E):parseInt(l.slice(-5,-2),10),r,n);if(A={epk:{x:C,crv:v,kty:b}},'EC'===b&&(A.epk.y=W),r&&(A.apu=(0,c.encode)(r)),n&&(A.apv=(0,c.encode)(n)),'ECDH-ES'===l){S=h;break}S=k||(0,p.generateCek)(E);const H=l.slice(-6);f=await e.wrap(H,h,S);break}case'RSA-OAEP':case'RSA-OAEP-256':case'RSA-OAEP-384':case'RSA-OAEP-512':S=k||(0,p.generateCek)(E),(0,u.assertCryptoKey)(w),f=await n.encrypt(l,w,S);break;case'PBES2-HS256+A128KW':case'PBES2-HS384+A192KW':case'PBES2-HS512+A256KW':{S=k||(0,p.generateCek)(E);const{p2c:e,p2s:t}=K;({encryptedKey:f,...A}=await r.wrap(l,w,S,e,t));break}case'A128KW':case'A192KW':case'A256KW':S=k||(0,p.generateCek)(E),f=await e.wrap(l,w,S);break;case'A128GCMKW':case'A192GCMKW':case'A256GCMKW':{S=k||(0,p.generateCek)(E);const{iv:e}=K;({encryptedKey:f,...A}=await(0,y.wrap)(l,w,S,e));break}default:throw new s.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:S,encryptedKey:f,parameters:A}};var e=l(_r(d[0])),t=l(_r(d[1])),r=l(_r(d[2])),n=l(_r(d[3])),c=_r(d[4]),o=_r(d[5]),p=_r(d[6]),s=_r(d[7]),i=_r(d[8]),y=_r(d[9]),u=_r(d[10]);function l(e,t){if("function"==typeof WeakMap)var r=new WeakMap,n=new WeakMap;return(l=function(e,t){if(!t&&e&&e.__esModule)return e;var c,o,p={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return p;if(c=t?n:r){if(c.has(e))return c.get(e);c.set(e,p)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((o=(c=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(o.get||o.set)?c(p,t,o):p[t]=e[t]);return p})(e,t)}},793,[772,773,775,776,758,786,778,763,794,782,768]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.exportJWK=async function(n){return(0,t.keyToJWK)(n)},e.exportPKCS8=async function(t){return(0,n.toPKCS8)(t)},e.exportSPKI=async function(t){return(0,n.toSPKI)(t)};var n=r(d[0]),t=r(d[1])},794,[780,795]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.keyToJWK=async function(y){if((0,n.isKeyObject)(y)){if('secret'!==y.type)return y.export({format:'jwk'});y=y.export()}if(y instanceof Uint8Array)return{kty:'oct',k:(0,o.encode)(y)};if(!(0,n.isCryptoKey)(y))throw new TypeError((0,t.invalidKeyInput)(y,'CryptoKey','KeyObject','Uint8Array'));if(!y.extractable)throw new TypeError('non-extractable CryptoKey cannot be exported as a JWK');const{ext:c,key_ops:p,alg:s,use:f,...u}=await crypto.subtle.exportKey('jwk',y);'AKP'===u.kty&&(u.alg=s);return u};var t=r(d[0]),o=r(d[1]),n=r(d[2])},795,[767,758,768]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.compactVerify=async function(c,f,p){c instanceof Uint8Array&&(c=o.decoder.decode(c));if('string'!=typeof c)throw new n.JWSInvalid('Compact JWS must be a string or Uint8Array');const{0:y,1:l,2:s,length:u}=c.split('.');if(3!==u)throw new n.JWSInvalid('Invalid Compact JWS');const v=await(0,t.flattenedVerify)({payload:l,protected:y,signature:s},f,p),w={payload:v.payload,protectedHeader:v.protectedHeader};if('function'==typeof f)return{...w,key:v.key};return w};var t=r(d[0]),n=r(d[1]),o=r(d[2])},796,[797,763,759]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.flattenedVerify=async function(f,v,S){if(!(0,s.isObject)(f))throw new n.JWSInvalid('Flattened JWS must be an object');if(void 0===f.protected&&void 0===f.header)throw new n.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==f.protected&&'string'!=typeof f.protected)throw new n.JWSInvalid('JWS Protected Header incorrect type');if(void 0===f.payload)throw new n.JWSInvalid('JWS Payload missing');if('string'!=typeof f.signature)throw new n.JWSInvalid('JWS Signature missing or incorrect type');if(void 0!==f.header&&!(0,s.isObject)(f.header))throw new n.JWSInvalid('JWS Unprotected Header incorrect type');let J={};if(f.protected)try{const o=(0,t.decode)(f.protected);J=JSON.parse(l.decoder.decode(o))}catch{throw new n.JWSInvalid('JWS Protected Header is invalid')}if(!(0,c.isDisjoint)(J,f.header))throw new n.JWSInvalid('JWS Protected and JWS Unprotected Header Parameter names must be disjoint');const W={...J,...f.header},u=(0,p.validateCrit)(n.JWSInvalid,new Map([['b64',!0]]),S?.crit,J,W);let b=!0;if(u.has('b64')&&(b=J.b64,'boolean'!=typeof b))throw new n.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:I}=W;if('string'!=typeof I||!I)throw new n.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');const P=S&&(0,h.validateAlgorithms)('algorithms',S.algorithms);if(P&&!P.has(I))throw new n.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter value not allowed');if(b){if('string'!=typeof f.payload)throw new n.JWSInvalid('JWS Payload must be a string')}else if('string'!=typeof f.payload&&!(f.payload instanceof Uint8Array))throw new n.JWSInvalid('JWS Payload must be a string or an Uint8Array instance');let H=!1;'function'==typeof v&&(v=await v(J,f),H=!0);(0,y.checkKeyType)(I,v,'verify');const A=(0,l.concat)(void 0!==f.protected?(0,l.encode)(f.protected):new Uint8Array,(0,l.encode)('.'),'string'==typeof f.payload?b?(0,l.encode)(f.payload):l.encoder.encode(f.payload):f.payload);let j;try{j=(0,t.decode)(f.signature)}catch{throw new n.JWSInvalid('Failed to base64url decode the signature')}const F=await(0,w.normalizeKey)(v,I);if(!await(0,o.verify)(I,F,j,A))throw new n.JWSSignatureVerificationFailed;let O;if(b)try{O=(0,t.decode)(f.payload)}catch{throw new n.JWSInvalid('Failed to base64url decode the payload')}else O='string'==typeof f.payload?l.encoder.encode(f.payload):f.payload;const U={payload:O};void 0!==f.protected&&(U.protectedHeader=J);void 0!==f.header&&(U.unprotectedHeader=f.header);if(H)return{...U,key:F};return U};var t=r(d[0]),o=r(d[1]),n=r(d[2]),l=r(d[3]),c=r(d[4]),s=r(d[5]),y=r(d[6]),p=r(d[7]),h=r(d[8]),w=r(d[9])},797,[758,798,763,759,769,770,788,784,785,786]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.verify=async function(o,y,u,f){const l=await(0,n.getSigKey)(o,y,'verify');(0,c.checkKeyLength)(o,l);const s=(0,t.subtleAlgorithm)(o,l.algorithm);try{return await crypto.subtle.verify(s,l,u,f)}catch{return!1}};var t=r(d[0]),c=r(d[1]),n=r(d[2])},798,[799,777,800]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.subtleAlgorithm=function(S,t){const c=`SHA-${S.slice(-3)}`;switch(S){case'HS256':case'HS384':case'HS512':return{hash:c,name:'HMAC'};case'PS256':case'PS384':case'PS512':return{hash:c,name:'RSA-PSS',saltLength:parseInt(S.slice(-3),10)>>3};case'RS256':case'RS384':case'RS512':return{hash:c,name:'RSASSA-PKCS1-v1_5'};case'ES256':case'ES384':case'ES512':return{hash:c,name:'ECDSA',namedCurve:t.namedCurve};case'Ed25519':case'EdDSA':return{name:'Ed25519'};case'ML-DSA-44':case'ML-DSA-65':case'ML-DSA-87':return{name:S};default:throw new s.JOSENotSupported(`alg ${S} is not supported either by JOSE or your javascript runtime`)}};var s=r(d[0])},799,[763]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.getSigKey=async function(y,o,c){if(o instanceof Uint8Array){if(!y.startsWith('HS'))throw new TypeError((0,n.invalidKeyInput)(o,'CryptoKey','KeyObject','JSON Web Key'));return crypto.subtle.importKey('raw',o,{hash:`SHA-${y.slice(-3)}`,name:'HMAC'},!1,[c])}return(0,t.checkSigCryptoKey)(o,y,c),o};var t=r(d[0]),n=r(d[1])},800,[766,767]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.generalVerify=async function(s,c,u){if(!(0,o.isObject)(s))throw new n.JWSInvalid('General JWS must be an object');if(!Array.isArray(s.signatures)||!s.signatures.every(o.isObject))throw new n.JWSInvalid('JWS Signatures missing or incorrect type');for(const n of s.signatures)try{return await(0,t.flattenedVerify)({header:n.header,payload:s.payload,protected:n.protected,signature:n.signature},c,u)}catch{}throw new n.JWSSignatureVerificationFailed};var t=r(d[0]),n=r(d[1]),o=r(d[2])},801,[797,763,770]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.jwtVerify=async function(n,p,u){const y=await(0,t.compactVerify)(n,p,u);if(y.protectedHeader.crit?.includes('b64')&&!1===y.protectedHeader.b64)throw new c.JWTInvalid('JWTs MUST NOT use unencoded payload');const f={payload:(0,o.validateClaimsSet)(y.protectedHeader,y.payload,u),protectedHeader:y.protectedHeader};if('function'==typeof p)return{...f,key:y.key};return f};var t=r(d[0]),o=r(d[1]),c=r(d[2])},802,[796,803,763]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.JWTClaimsBuilder=void 0,e.secs=y,e.validateClaimsSet=function(c,l,u={}){let p;try{p=JSON.parse(s.decoder.decode(l))}catch{}if(!(0,o.isObject)(p))throw new t.JWTInvalid('JWT Claims Set must be a top-level JSON object');const{typ:h}=u;if(h&&('string'!=typeof c.typ||b(c.typ)!==b(h)))throw new t.JWTClaimValidationFailed('unexpected "typ" JWT header value',p,'typ','check_failed');const{requiredClaims:f=[],issuer:w,subject:k,audience:v,maxTokenAge:x}=u,J=[...f];void 0!==x&&J.push('iat');void 0!==v&&J.push('aud');void 0!==k&&J.push('sub');void 0!==w&&J.push('iss');for(const s of new Set(J.reverse()))if(!(s in p))throw new t.JWTClaimValidationFailed(`missing required "${s}" claim`,p,s,'missing');if(w&&!(Array.isArray(w)?w:[w]).includes(p.iss))throw new t.JWTClaimValidationFailed('unexpected "iss" claim value',p,'iss','check_failed');if(k&&p.sub!==k)throw new t.JWTClaimValidationFailed('unexpected "sub" claim value',p,'sub','check_failed');if(v&&!T(p.aud,'string'==typeof v?[v]:v))throw new t.JWTClaimValidationFailed('unexpected "aud" claim value',p,'aud','check_failed');let C;switch(typeof u.clockTolerance){case'string':C=y(u.clockTolerance);break;case'number':C=u.clockTolerance;break;case'undefined':C=0;break;default:throw new TypeError('Invalid clockTolerance option type')}const{currentDate:W}=u,F=n(W||new Date);if((void 0!==p.iat||x)&&'number'!=typeof p.iat)throw new t.JWTClaimValidationFailed('"iat" claim must be a number',p,'iat','invalid');if(void 0!==p.nbf){if('number'!=typeof p.nbf)throw new t.JWTClaimValidationFailed('"nbf" claim must be a number',p,'nbf','invalid');if(p.nbf>F+C)throw new t.JWTClaimValidationFailed('"nbf" claim timestamp check failed',p,'nbf','check_failed')}if(void 0!==p.exp){if('number'!=typeof p.exp)throw new t.JWTClaimValidationFailed('"exp" claim must be a number',p,'exp','invalid');if(p.exp<=F-C)throw new t.JWTExpired('"exp" claim timestamp check failed',p,'exp','check_failed')}if(x){const s=F-p.iat;if(s-C>('number'==typeof x?x:y(x)))throw new t.JWTExpired('"iat" claim timestamp check failed (too far in the past)',p,'iat','check_failed');if(s<0-C)throw new t.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',p,'iat','check_failed')}return p};var t=r(d[0]),s=r(d[1]),o=r(d[2]);const n=t=>Math.floor(t.getTime()/1e3),c=60,l=3600,u=86400,p=604800,h=31557600,f=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i;function y(t){const s=f.exec(t);if(!s||s[4]&&s[1])throw new TypeError('Invalid time period format');const o=parseFloat(s[2]);let n;switch(s[3].toLowerCase()){case'sec':case'secs':case'second':case'seconds':case's':n=Math.round(o);break;case'minute':case'minutes':case'min':case'mins':case'm':n=Math.round(o*c);break;case'hour':case'hours':case'hr':case'hrs':case'h':n=Math.round(o*l);break;case'day':case'days':case'd':n=Math.round(o*u);break;case'week':case'weeks':case'w':n=Math.round(o*p);break;default:n=Math.round(o*h)}return'-'===s[1]||'ago'===s[4]?-n:n}function w(t,s){if(!Number.isFinite(s))throw new TypeError(`Invalid ${t} input`);return s}const b=t=>t.includes('/')?t.toLowerCase():`application/${t.toLowerCase()}`,T=(t,s)=>'string'==typeof t?s.includes(t):!!Array.isArray(t)&&s.some(Set.prototype.has.bind(new Set(t)));e.JWTClaimsBuilder=class{#e;constructor(t){if(!(0,o.isObject)(t))throw new TypeError('JWT Claims Set MUST be an object');this.#e=structuredClone(t)}data(){return s.encoder.encode(JSON.stringify(this.#e))}get iss(){return this.#e.iss}set iss(t){this.#e.iss=t}get sub(){return this.#e.sub}set sub(t){this.#e.sub=t}get aud(){return this.#e.aud}set aud(t){this.#e.aud=t}set jti(t){this.#e.jti=t}set nbf(t){'number'==typeof t?this.#e.nbf=w('setNotBefore',t):t instanceof Date?this.#e.nbf=w('setNotBefore',n(t)):this.#e.nbf=n(new Date)+y(t)}set exp(t){'number'==typeof t?this.#e.exp=w('setExpirationTime',t):t instanceof Date?this.#e.exp=w('setExpirationTime',n(t)):this.#e.exp=n(new Date)+y(t)}set iat(t){void 0===t?this.#e.iat=n(new Date):t instanceof Date?this.#e.iat=w('setIssuedAt',n(t)):this.#e.iat=w('setIssuedAt','string'==typeof t?n(new Date)+y(t):t)}}},803,[763,759,770]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.jwtDecrypt=async function(o,l,n){const u=await(0,t.compactDecrypt)(o,l,n),p=(0,s.validateClaimsSet)(u.protectedHeader,u.plaintext,n),{protectedHeader:h}=u;if(void 0!==h.iss&&h.iss!==p.iss)throw new c.JWTClaimValidationFailed('replicated "iss" claim header parameter mismatch',p,'iss','mismatch');if(void 0!==h.sub&&h.sub!==p.sub)throw new c.JWTClaimValidationFailed('replicated "sub" claim header parameter mismatch',p,'sub','mismatch');if(void 0!==h.aud&&JSON.stringify(h.aud)!==JSON.stringify(p.aud))throw new c.JWTClaimValidationFailed('replicated "aud" claim header parameter mismatch',p,'aud','mismatch');const f={payload:p,protectedHeader:h};if('function'==typeof l)return{...f,key:u.key};return f};var t=r(d[0]),s=r(d[1]),c=r(d[2])},804,[756,803,763]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.CompactEncrypt=void 0;var t=r(d[0]);e.CompactEncrypt=class{#t;constructor(n){this.#t=new t.FlattenedEncrypt(n)}setContentEncryptionKey(t){return this.#t.setContentEncryptionKey(t),this}setInitializationVector(t){return this.#t.setInitializationVector(t),this}setProtectedHeader(t){return this.#t.setProtectedHeader(t),this}setKeyManagementParameters(t){return this.#t.setKeyManagementParameters(t),this}async encrypt(t,n){const s=await this.#t.encrypt(t,n);return[s.protected,s.encrypted_key,s.iv,s.ciphertext,s.tag].join('.')}}},805,[791]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.CompactSign=void 0;var t=r(d[0]);e.CompactSign=class{#e;constructor(n){this.#e=new t.FlattenedSign(n)}setProtectedHeader(t){return this.#e.setProtectedHeader(t),this}async sign(t,n){const o=await this.#e.sign(t,n);if(void 0===o.payload)throw new TypeError('use the flattened module for creating JWS with b64: false');return`${o.protected}.${o.payload}.${o.signature}`}}},806,[807]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.FlattenedSign=void 0;var t=r(d[0]),o=r(d[1]),n=r(d[2]),c=r(d[3]),s=r(d[4]),p=r(d[5]),l=r(d[6]),h=r(d[7]);e.FlattenedSign=class{#e;#t;#r;constructor(t){if(!(t instanceof Uint8Array))throw new TypeError('payload must be an instance of Uint8Array');this.#e=t}setProtectedHeader(t){if(this.#t)throw new TypeError('setProtectedHeader can only be called once');return this.#t=t,this}setUnprotectedHeader(t){if(this.#r)throw new TypeError('setUnprotectedHeader can only be called once');return this.#r=t,this}async sign(H,y){if(!this.#t&&!this.#r)throw new c.JWSInvalid('either setProtectedHeader or setUnprotectedHeader must be called before #sign()');if(!(0,n.isDisjoint)(this.#t,this.#r))throw new c.JWSInvalid('JWS Protected and JWS Unprotected Header Parameter names must be disjoint');const u={...this.#t,...this.#r};let w=!0;if((0,l.validateCrit)(c.JWSInvalid,new Map([['b64',!0]]),y?.crit,this.#t,u).has('b64')&&(w=this.#t.b64,'boolean'!=typeof w))throw new c.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:b}=u;if('string'!=typeof b||!b)throw new c.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let f,S,v,J;(0,p.checkKeyType)(b,H,'sign'),w?(f=(0,t.encode)(this.#e),S=(0,s.encode)(f)):(S=this.#e,f=''),this.#t?(v=(0,t.encode)(JSON.stringify(this.#t)),J=(0,s.encode)(v)):(v='',J=new Uint8Array);const P=(0,s.concat)(J,(0,s.encode)('.'),S),W=await(0,h.normalizeKey)(H,b),U=await(0,o.sign)(b,W,P),I={signature:(0,t.encode)(U),payload:f};return this.#r&&(I.header=this.#r),this.#t&&(I.protected=v),I}}},807,[758,808,769,763,759,788,784,786]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.sign=async function(o,s,u){const l=await(0,c.getSigKey)(o,s,'sign');(0,n.checkKeyLength)(o,l);const y=await crypto.subtle.sign((0,t.subtleAlgorithm)(o,l.algorithm),l,u);return new Uint8Array(y)};var t=r(d[0]),n=r(d[1]),c=r(d[2])},808,[799,777,800]);
__d(function(g,r,_i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.GeneralSign=void 0;var t=r(d[0]),n=r(d[1]);class s{#e;constructor(t,n,s){this.#e=t,this.key=n,this.options=s}setProtectedHeader(t){if(this.protectedHeader)throw new TypeError('setProtectedHeader can only be called once');return this.protectedHeader=t,this}setUnprotectedHeader(t){if(this.unprotectedHeader)throw new TypeError('setUnprotectedHeader can only be called once');return this.unprotectedHeader=t,this}addSignature(...t){return this.#e.addSignature(...t)}sign(...t){return this.#e.sign(...t)}done(){return this.#e}}e.GeneralSign=class{#t;#n=[];constructor(t){this.#t=t}addSignature(t,n){const i=new s(this,t,n);return this.#n.push(i),i}async sign(){if(!this.#n.length)throw new n.JWSInvalid('at least one signature must be added');const s={signatures:[],payload:''};for(let i=0;i<this.#n.length;i++){const o=this.#n[i],c=new t.FlattenedSign(this.#t);c.setProtectedHeader(o.protectedHeader),c.setUnprotectedHeader(o.unprotectedHeader);const{payload:u,...l}=await c.sign(o.key,o.options);if(0===i)s.payload=u;else if(s.payload!==u)throw new n.JWSInvalid('inconsistent use of JWS Unencoded Payload (RFC7797)');s.signatures.push(l)}return s}}},809,[807,763]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.SignJWT=void 0;var t=r(d[0]),s=r(d[1]),n=r(d[2]);e.SignJWT=class{#t;#e;constructor(t={}){this.#e=new n.JWTClaimsBuilder(t)}setIssuer(t){return this.#e.iss=t,this}setSubject(t){return this.#e.sub=t,this}setAudience(t){return this.#e.aud=t,this}setJti(t){return this.#e.jti=t,this}setNotBefore(t){return this.#e.nbf=t,this}setExpirationTime(t){return this.#e.exp=t,this}setIssuedAt(t){return this.#e.iat=t,this}setProtectedHeader(t){return this.#t=t,this}async sign(n,h){const u=new t.CompactSign(this.#e.data());if(u.setProtectedHeader(this.#t),Array.isArray(this.#t?.crit)&&this.#t.crit.includes('b64')&&!1===this.#t.b64)throw new s.JWTInvalid('JWTs MUST NOT use unencoded payload');return u.sign(n,h)}}},810,[806,763,803]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.EncryptJWT=void 0;var t=r(d[0]),s=r(d[1]);e.EncryptJWT=class{#e;#t;#r;#s;#i;#a;#n;#c;constructor(t={}){this.#c=new s.JWTClaimsBuilder(t)}setIssuer(t){return this.#c.iss=t,this}setSubject(t){return this.#c.sub=t,this}setAudience(t){return this.#c.aud=t,this}setJti(t){return this.#c.jti=t,this}setNotBefore(t){return this.#c.nbf=t,this}setExpirationTime(t){return this.#c.exp=t,this}setIssuedAt(t){return this.#c.iat=t,this}setProtectedHeader(t){if(this.#s)throw new TypeError('setProtectedHeader can only be called once');return this.#s=t,this}setKeyManagementParameters(t){if(this.#r)throw new TypeError('setKeyManagementParameters can only be called once');return this.#r=t,this}setContentEncryptionKey(t){if(this.#e)throw new TypeError('setContentEncryptionKey can only be called once');return this.#e=t,this}setInitializationVector(t){if(this.#t)throw new TypeError('setInitializationVector can only be called once');return this.#t=t,this}replicateIssuerAsHeader(){return this.#i=!0,this}replicateSubjectAsHeader(){return this.#a=!0,this}replicateAudienceAsHeader(){return this.#n=!0,this}async encrypt(s,n){const c=new t.CompactEncrypt(this.#c.data());return this.#s&&(this.#i||this.#a||this.#n)&&(this.#s={...this.#s,iss:this.#i?this.#c.iss:void 0,sub:this.#a?this.#c.sub:void 0,aud:this.#n?this.#c.aud:void 0}),c.setProtectedHeader(this.#s),this.#t&&c.setInitializationVector(this.#t),this.#e&&c.setContentEncryptionKey(this.#e),this.#r&&c.setKeyManagementParameters(this.#r),c.encrypt(s,n)}}},811,[805,803]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.calculateJwkThumbprint=p,e.calculateJwkThumbprintUri=async function(t,n){n??='sha256';const o=await p(t,n);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${n.slice(-3)}:${o}`};var t=r(d[0]),n=r(d[1]),o=r(d[2]),s=r(d[3]),y=r(d[4]),c=r(d[5]),u=r(d[6]),k=r(d[7]);const l=(t,n)=>{if('string'!=typeof t||!t)throw new o.JWKInvalid(`${n} missing or invalid`)};async function p(p,h){let b,P;if((0,c.isJWK)(p))b=p;else{if(!(0,y.isKeyLike)(p))throw new TypeError((0,k.invalidKeyInput)(p,'CryptoKey','KeyObject','JSON Web Key'));b=await(0,u.exportJWK)(p)}if(h??='sha256','sha256'!==h&&'sha384'!==h&&'sha512'!==h)throw new TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(b.kty){case'AKP':l(b.alg,'"alg" (Algorithm) Parameter'),l(b.pub,'"pub" (Public key) Parameter'),P={alg:b.alg,kty:b.kty,pub:b.pub};break;case'EC':l(b.crv,'"crv" (Curve) Parameter'),l(b.x,'"x" (X Coordinate) Parameter'),l(b.y,'"y" (Y Coordinate) Parameter'),P={crv:b.crv,kty:b.kty,x:b.x,y:b.y};break;case'OKP':l(b.crv,'"crv" (Subtype of Key Pair) Parameter'),l(b.x,'"x" (Public Key) Parameter'),P={crv:b.crv,kty:b.kty,x:b.x};break;case'RSA':l(b.e,'"e" (Exponent) Parameter'),l(b.n,'"n" (Modulus) Parameter'),P={e:b.e,kty:b.kty,n:b.n};break;case'oct':l(b.k,'"k" (Key Value) Parameter'),P={k:b.k,kty:b.kty};break;default:throw new o.JOSENotSupported('"kty" (Key Type) Parameter missing or unsupported')}const w=(0,s.encode)(JSON.stringify(P));return(0,n.encode)(await(0,t.digest)(h,w))}},812,[774,758,763,759,768,787,794,767]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.EmbeddedJWK=async function(o,b){const u={...o,...b?.header};if(!(0,n.isObject)(u.jwk))throw new c.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a JSON object');const w=await(0,t.importJWK)({...u.jwk,ext:!0},u.alg);if(w instanceof Uint8Array||'public'!==w.type)throw new c.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a public key');return w};var t=r(d[0]),n=r(d[1]),c=r(d[2])},813,[779,770,763]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.createLocalJWKSet=function(t){const s=new y(t),n=async(t,n)=>s.getKey(t,n);return Object.defineProperties(n,{jwks:{value:()=>structuredClone(s.jwks()),enumerable:!1,configurable:!1,writable:!1}}),n};var t=r(d[0]),s=r(d[1]),n=r(d[2]);function c(t){switch('string'==typeof t&&t.slice(0,2)){case'RS':case'PS':return'RSA';case'ES':return'EC';case'Ed':return'OKP';case'ML':return'AKP';default:throw new s.JOSENotSupported('Unsupported "alg" value for a JSON Web Key Set')}}function o(t){return t&&'object'==typeof t&&Array.isArray(t.keys)&&t.keys.every(u)}function u(t){return(0,n.isObject)(t)}class y{#e;#t=new WeakMap;constructor(t){if(!o(t))throw new s.JWKSInvalid('JSON Web Key Set malformed');this.#e=structuredClone(t)}jwks(){return this.#e}async getKey(t,n){const{alg:o,kid:u}={...t,...n?.header},y=c(o),f=this.#e.keys.filter(t=>{let s=y===t.kty;if(s&&'string'==typeof u&&(s=u===t.kid),!s||'string'!=typeof t.alg&&'AKP'!==y||(s=o===t.alg),s&&'string'==typeof t.use&&(s='sig'===t.use),s&&Array.isArray(t.key_ops)&&(s=t.key_ops.includes('verify')),s)switch(o){case'ES256':s='P-256'===t.crv;break;case'ES384':s='P-384'===t.crv;break;case'ES512':s='P-521'===t.crv;break;case'Ed25519':case'EdDSA':s='Ed25519'===t.crv}return s}),{0:w,length:S}=f;if(0===S)throw new s.JWKSNoMatchingKey;if(1!==S){const t=new s.JWKSMultipleMatchingKeys,n=this.#t;throw t[Symbol.asyncIterator]=async function*(){for(const t of f)try{yield await l(n,t,o)}catch{}},t}return l(this.#t,w,o)}}async function l(n,c,o){const u=n.get(c)||n.set(c,{}).get(c);if(void 0===u[o]){const n=await(0,t.importJWK)({...c,ext:!0},o);if(n instanceof Uint8Array||'public'!==n.type)throw new s.JWKSInvalid('JSON Web Key Set members must be public keys');u[o]=n}return u[o]}},814,[779,763,770]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.createRemoteJWKSet=function(t,o){const s=new l(t,o),n=async(t,o)=>s.getKey(t,o);return Object.defineProperties(n,{coolingDown:{get:()=>s.coolingDown(),enumerable:!0,configurable:!1},fresh:{get:()=>s.fresh(),enumerable:!0,configurable:!1},reload:{value:()=>s.reload(),enumerable:!0,configurable:!1,writable:!1},reloading:{get:()=>s.pendingFetch(),enumerable:!0,configurable:!1},jwks:{value:()=>s.jwks(),enumerable:!0,configurable:!1,writable:!1}}),n},e.jwksCache=e.customFetch=void 0;var t=r(d[0]),o=r(d[1]),s=r(d[2]);let n;if('undefined'==typeof navigator||!navigator.userAgent?.startsWith?.('Mozilla/5.0 ')){n=`${'jose'}/${'v6.1.2'}`}const c=e.customFetch=Symbol();async function h(o,s,n,c=fetch){const h=await c(o,{method:'GET',signal:n,redirect:'manual',headers:s}).catch(o=>{if('TimeoutError'===o.name)throw new t.JWKSTimeout;throw o});if(200!==h.status)throw new t.JOSEError('Expected 200 OK from the JSON Web Key Set HTTP response');try{return await h.json()}catch{throw new t.JOSEError('Failed to parse the JSON Web Key Set HTTP response as JSON')}}const u=e.jwksCache=Symbol();class l{#e;#t;#a;#i;#o;#s;#n;#r;#c;#h;constructor(t,h){if(!(t instanceof URL))throw new TypeError('url must be an instance of URL');var l,w;this.#e=new URL(t.href),this.#t='number'==typeof h?.timeoutDuration?h?.timeoutDuration:5e3,this.#a='number'==typeof h?.cooldownDuration?h?.cooldownDuration:3e4,this.#i='number'==typeof h?.cacheMaxAge?h?.cacheMaxAge:6e5,this.#n=new Headers(h?.headers),n&&!this.#n.has('User-Agent')&&this.#n.set('User-Agent',n),this.#n.has('accept')||(this.#n.set('accept','application/json'),this.#n.append('accept','application/jwk-set+json')),this.#r=h?.[c],void 0!==h?.[u]&&(this.#h=h?.[u],l=h?.[u],w=this.#i,'object'==typeof l&&null!==l&&'uat'in l&&'number'==typeof l.uat&&!(Date.now()-l.uat>=w)&&'jwks'in l&&(0,s.isObject)(l.jwks)&&Array.isArray(l.jwks.keys)&&Array.prototype.every.call(l.jwks.keys,s.isObject)&&(this.#o=this.#h.uat,this.#c=(0,o.createLocalJWKSet)(this.#h.jwks)))}pendingFetch(){return!!this.#s}coolingDown(){return'number'==typeof this.#o&&Date.now()<this.#o+this.#a}fresh(){return'number'==typeof this.#o&&Date.now()<this.#o+this.#i}jwks(){return this.#c?.jwks()}async getKey(o,s){this.#c&&this.fresh()||await this.reload();try{return await this.#c(o,s)}catch(n){if(n instanceof t.JWKSNoMatchingKey&&!1===this.coolingDown())return await this.reload(),this.#c(o,s);throw n}}async reload(){this.#s&&('undefined'!=typeof WebSocketPair||'undefined'!=typeof navigator&&'Cloudflare-Workers'===navigator.userAgent||'undefined'!=typeof EdgeRuntime&&'vercel'===EdgeRuntime)&&(this.#s=void 0),this.#s||=h(this.#e.href,this.#n,AbortSignal.timeout(this.#t),this.#r).then(t=>{this.#c=(0,o.createLocalJWKSet)(t),this.#h&&(this.#h.uat=Date.now(),this.#h.jwks=t),this.#o=Date.now(),this.#s=void 0}).catch(t=>{throw this.#s=void 0,t}),await this.#s}}},815,[763,814,770]);
__d(function(g,_r,_i,a,m,_e,d){Object.defineProperty(_e,"__esModule",{value:!0}),_e.UnsecuredJWT=void 0;var e=(function(e,t){if("function"==typeof WeakMap)var r=new WeakMap,n=new WeakMap;return(function(e,t){if(!t&&e&&e.__esModule)return e;var i,s,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(i=t?n:r){if(i.has(e))return i.get(e);i.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((s=(i=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(s.get||s.set)?i(o,t,s):o[t]=e[t]);return o})(e,t)})(_r(d[0])),t=_r(d[1]),r=_r(d[2]),n=_r(d[3]);_e.UnsecuredJWT=class{#e;constructor(e={}){this.#e=new n.JWTClaimsBuilder(e)}encode(){return`${e.encode(JSON.stringify({alg:'none'}))}.${e.encode(this.#e.data())}.`}setIssuer(e){return this.#e.iss=e,this}setSubject(e){return this.#e.sub=e,this}setAudience(e){return this.#e.aud=e,this}setJti(e){return this.#e.jti=e,this}setNotBefore(e){return this.#e.nbf=e,this}setExpirationTime(e){return this.#e.exp=e,this}setIssuedAt(e){return this.#e.iat=e,this}static decode(i,s){if('string'!=typeof i)throw new r.JWTInvalid('Unsecured JWT must be a string');const{0:o,1:u,2:c,length:l}=i.split('.');if(3!==l||''!==c)throw new r.JWTInvalid('Invalid Unsecured JWT');let f;try{if(f=JSON.parse(t.decoder.decode(e.decode(o))),'none'!==f.alg)throw new Error}catch{throw new r.JWTInvalid('Invalid Unsecured JWT')}return{payload:(0,n.validateClaimsSet)(f,e.decode(u),s),header:f}}}},816,[758,759,763,803]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.decodeProtectedHeader=function(c){let f;if('string'==typeof c){const t=c.split('.');3!==t.length&&5!==t.length||([f]=t)}else if('object'==typeof c&&c){if(!('protected'in c))throw new TypeError('Token does not contain a Protected Header');f=c.protected}try{if('string'!=typeof f||!f)throw new Error;const c=JSON.parse(o.decoder.decode((0,t.decode)(f)));if(!(0,n.isObject)(c))throw new Error;return c}catch{throw new TypeError('Invalid Token or Protected Header formatting')}};var t=r(d[0]),o=r(d[1]),n=r(d[2])},817,[758,759,770]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.decodeJwt=function(s){if('string'!=typeof s)throw new l.JWTInvalid('JWTs must use Compact JWS serialization, JWT must be a string');const{1:c,length:J}=s.split('.');if(5===J)throw new l.JWTInvalid('Only JWTs using Compact JWS serialization can be decoded');if(3!==J)throw new l.JWTInvalid('Invalid JWT');if(!c)throw new l.JWTInvalid('JWTs must contain a payload');let w,W;try{w=(0,t.decode)(c)}catch{throw new l.JWTInvalid('Failed to base64url decode the payload')}try{W=JSON.parse(n.decoder.decode(w))}catch{throw new l.JWTInvalid('Failed to parse the decoded payload as JSON')}if(!(0,o.isObject)(W))throw new l.JWTInvalid('Invalid JWT Claims Set');return W};var t=r(d[0]),n=r(d[1]),o=r(d[2]),l=r(d[3])},818,[758,759,770,763]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.generateKeyPair=async function(t,c){let o,u;switch(t){case'PS256':case'PS384':case'PS512':o={name:'RSA-PSS',hash:`SHA-${t.slice(-3)}`,publicExponent:Uint8Array.of(1,0,1),modulusLength:s(c)},u=['sign','verify'];break;case'RS256':case'RS384':case'RS512':o={name:'RSASSA-PKCS1-v1_5',hash:`SHA-${t.slice(-3)}`,publicExponent:Uint8Array.of(1,0,1),modulusLength:s(c)},u=['sign','verify'];break;case'RSA-OAEP':case'RSA-OAEP-256':case'RSA-OAEP-384':case'RSA-OAEP-512':o={name:'RSA-OAEP',hash:`SHA-${parseInt(t.slice(-3),10)||1}`,publicExponent:Uint8Array.of(1,0,1),modulusLength:s(c)},u=['decrypt','unwrapKey','encrypt','wrapKey'];break;case'ES256':o={name:'ECDSA',namedCurve:'P-256'},u=['sign','verify'];break;case'ES384':o={name:'ECDSA',namedCurve:'P-384'},u=['sign','verify'];break;case'ES512':o={name:'ECDSA',namedCurve:'P-521'},u=['sign','verify'];break;case'Ed25519':case'EdDSA':u=['sign','verify'],o={name:'Ed25519'};break;case'ML-DSA-44':case'ML-DSA-65':case'ML-DSA-87':u=['sign','verify'],o={name:t};break;case'ECDH-ES':case'ECDH-ES+A128KW':case'ECDH-ES+A192KW':case'ECDH-ES+A256KW':{u=['deriveBits'];const s=c?.crv??'P-256';switch(s){case'P-256':case'P-384':case'P-521':o={name:'ECDH',namedCurve:s};break;case'X25519':o={name:'X25519'};break;default:throw new n.JOSENotSupported('Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, and X25519')}break}default:throw new n.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return crypto.subtle.generateKey(o,c?.extractable??!1,u)};var n=r(d[0]);function s(s){const t=s?.modulusLength??2048;if('number'!=typeof t||t<2048)throw new n.JOSENotSupported('Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used');return t}},819,[763]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.generateSecret=async function(s,c){let n,l,A;switch(s){case'HS256':case'HS384':case'HS512':n=parseInt(s.slice(-3),10),l={name:'HMAC',hash:`SHA-${n}`,length:n},A=['sign','verify'];break;case'A128CBC-HS256':case'A192CBC-HS384':case'A256CBC-HS512':return n=parseInt(s.slice(-3),10),crypto.getRandomValues(new Uint8Array(n>>3));case'A128KW':case'A192KW':case'A256KW':n=parseInt(s.slice(1,4),10),l={name:'AES-KW',length:n},A=['wrapKey','unwrapKey'];break;case'A128GCMKW':case'A192GCMKW':case'A256GCMKW':case'A128GCM':case'A192GCM':case'A256GCM':n=parseInt(s.slice(1,4),10),l={name:'AES-GCM',length:n},A=['encrypt','decrypt'];break;default:throw new t.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return crypto.subtle.generateKey(l,c?.extractable??!1,A)};var t=r(d[0])},820,[763]);
__d(function(g,_r,_i,a,m,_e,d){Object.defineProperty(_e,"__esModule",{value:!0}),_e.GET=async function(r){try{const o=r.headers.get("cookie");if(!o)return Response.json({error:"Not authenticated"},{status:401});const n={};if(o.split(";").forEach(e=>{const t=e.trim();if(t.includes("=")){const[e,r]=t.split("="),o=e.trim();n[o]?n[o].value=r:n[o]={value:r}}else if("httponly"===t.toLowerCase()){const e=Object.keys(n).pop();e&&(n[e].httpOnly="true")}else if(t.toLowerCase().startsWith("expires=")){const e=Object.keys(n).pop();e&&(n[e].expires=t.substring(8))}else if(t.toLowerCase().startsWith("max-age=")){const e=Object.keys(n).pop();e&&(n[e].maxAge=t.substring(8))}}),!n[t.COOKIE_NAME]||!n[t.COOKIE_NAME].value)return Response.json({error:"Not authenticated"},{status:401});const s=n[t.COOKIE_NAME].value;try{const r=await e.jwtVerify(s,(new TextEncoder).encode(t.JWT_SECRET));let o=null;if(n[t.COOKIE_NAME].maxAge){const e=parseInt(n[t.COOKIE_NAME].maxAge,10);o=(r.payload.iat||Math.floor(Date.now()/1e3))+e}return Response.json({...r.payload,cookieExpiration:o})}catch(e){return Response.json({error:"Invalid token"},{status:401})}}catch(e){return console.error("Session error:",e),Response.json({error:"Server error"},{status:500})}};var e=(function(e,t){if("function"==typeof WeakMap)var r=new WeakMap,o=new WeakMap;return(function(e,t){if(!t&&e&&e.__esModule)return e;var n,s,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(n=t?o:r){if(n.has(e))return n.get(e);n.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((s=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(s.get||s.set)?n(i,t,s):i[t]=e[t]);return i})(e,t)})(_r(d[0])),t=_r(d[1])},1079,[755,754]);
module.exports = __r(1079);